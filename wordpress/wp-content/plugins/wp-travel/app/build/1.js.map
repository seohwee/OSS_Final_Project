{"version":3,"sources":["webpack:///./app/src/frontend/booking-widget/BookingCalender.js","webpack:///./app/src/frontend/booking-widget/functions.js","webpack:///./app/src/frontend/booking-widget/sub-components/DatesListing.js","webpack:///./app/src/frontend/booking-widget/sub-components/PaxSelector.js","webpack:///./app/src/frontend/booking-widget/sub-components/PricingListing.js","webpack:///./app/src/frontend/booking-widget/sub-components/TripExtrasListing.js","webpack:///./app/src/frontend/booking-widget/sub-components/TripTimesListing.js","webpack:///./app/src/frontend/booking-widget/sub-components/layout-v2/PaxSelectorV2.js","webpack:///./app/src/frontend/booking-widget/sub-components/layout-v2/PricingListingV2.js","webpack:///./app/src/frontend/booking-widget/sub-components/layout-v2/TripExtrasListingV2.js","webpack:///./app/src/frontend/booking-widget/sub-components/layout-v2/TripTimesListingV2.js"],"names":["_","lodash","storeName","_wp_travel","currencySymbol","currency_symbol","Notice","children","className","initialState","selectedDate","selectedTripDate","nomineePricings","nomineeTimes","selectedPricing","selectedDateTime","selectedTime","rruleAll","paxCounts","tripExtras","inventory","isLoading","excludedDateTimes","pricingUnavailable","tempExcludeDate","__i18n","strings","InventoryNotice","wp_travel_inventory_pax_limit_type","wp_travel_inventory_sold_out_action","wp_travel_inventory_custom_max_pax","wp_travel_inventory_sold_out_message","wp_travel_inventory_status_message_format","enquiryBtn","document","getElementById","click","trip_enquiry","bookings","pricing_not_available","BookingWidget","useState","setState","updateState","data","state","allData","useSelect","select","getAllStore","pricings","tripData","keyBy","p","id","_dates","dates","length","datesById","d","isFixedDeparture","is_fixed_departure","duration","trip_duration","days","parseInt","isTripInventoryEnabled","enable_trip_inventory","_excludedDatesTimes","excluded_dates_times","excludedDates","useEffect","filter","ed","trip_time","_times","split","_datetimes","map","t","moment","start_date","toDate","includes","format","push","Object","keys","handlePricingSelect","_state","times","getPricingTripTimes","setInventoryData","pricing","categories","_paxCounts","forEach","c","default_pax","maxPax","max_pax","_tripExtras","trip_extras","x","is_required","time","toDateString","find","et","isSame","generateRRule","startDate","ruleArgs","freq","RRule","DAILY","dtstart","until","selectedYears","years","year","selectedMonths","months","month","selectedDates","date_days","date","selectedDays","day","bymonth","m","byweekday","sd","bymonthday","md","rule","all","isTourDate","isBefore","Date","curretYear","getFullYear","currentDate","getDate","currentMonth","getMonth","UTC","utc","_date","is_recurring","end_date","toString","toLowerCase","isAfter","dateRules","applyFilters","da","unix","dayClicked","date_id","_dateIds","tripDateListing","_nomineePricings","pricing_ids","trim","chain","flatten","uniq","value","getPricingsByDate","returnDateIds","handleFixedDeparturePricingSelect","pricingId","handleTimeClick","handlePaxChange","e","category","count","_inventory","i","pax_available","_totalPax","size","values","reduce","acc","curr","target","parentElement","querySelector","em","createElement","classList","add","textContent","max_pax_exceeded","appendChild","setTimeout","remove","getCartTotal","withExtras","total","txTotal","tpax","entries","getCategoryPrice","tx","tour_extras_metas","price","is_sale","extras_item_sale_price","extras_item_price","parseFloat","addToCart","trip_id","arrival_date","pricing_id","pax","category_pax","trip_price","_txs","key","wp_travel_trip_extras","qty","wpTravelTimeout","apiFetch","url","wp_travel","ajaxUrl","_nonce","method","then","res","success","code","isEnabledCartPage","location","href","cartUrl","checkoutUrl","catch","error","alert","categoryId","sale_price","regular_price","has_group_price","group_prices","groupPrices","orderBy","gp","group_price","min_pax","price_per","selectedTripdates","td","ajax_url","join","jQuery","slideDown","DatePickerBtn","forwardRef","ref","onClick","itinerary_v2","date_select","_mindate","sortBy","minDate","maxDate","setFullYear","params","showMonthDropdown","customInput","showYearDropdown","dropdownMode","onChange","filterDate","endDate","totalPax","minPaxToBook","activeInventory","maxPaxToBook","trip_date_listing","paxSelectorData","onPaxChange","counts","selectedPricingId","selectedDateIds","onTimeSelect","console","log","booking_tab_content_label","_initialState","assign","booking_tab_clear_all","onDateClick","onFixedDeparturePricingSelect","date_select_to_view_options","title","date_format_moment","booking_tab_cart_total","__html","wpTravelFormat","booking_tab_booking_btn_label","currency","_currencySymbol","currencyPosition","currency_position","decimalSeparator","decimal_separator","_toFixed","number_of_decimals","kiloSeparator","thousand_separator","_num","style","regEx","RegExp","replaceWith","_formattedNum","toFixed","replace","positions","wpTravelFormatV2","promise","ms","Promise","resolve","reject","Error","wpTravelPHPtoMomentDateFormat","dateFormat","formats","datePerPage","rruleArgs","rruleSet","RRuleSet","rrule","generateRRUleArgs","rruleStartDate","RecurringDates","setRecurringDates","activeRecurringDates","setActiveRecurringDates","setRRuleArgs","showRecurringDates","showRecurringDatesToggle","setSelectedDate","activePage","datesPerPage","pagesCount","setPagination","nextStartDate","handleDateClick","handleFixedDeparturePricingClick","loadMoreDates","page","start","end","pagination","slice","_rruleArgs","dateIndex","_selectedDateTime","_pricingIds","firstPricingId","firstPricing","firstCategories","firstCounts","pricingOptions","pricingIndex","label","__","DatesListing","handleClick","top","offset","animate","scrollTop","handlePricingClick","nonRecurringDates","index","_start_date","recurring","DiscountTable","groupPricings","from","to","PaxSelector","single","booking_tab_pax_selector","term_info","booked_pax","group_discount_tooltip","enableBackground","view_group_discount","PricingListing","selected","options","onPricingSelect","pricings_list_label","TripExtrasListing","inc","_xcount","trip_extras_list_label","content","_count","link","trip_extras_link_label","TripTimesListing","available_trip_times","timeObject","PaxSelectorV2","toggler","groupDiscountClickhandler","dt","closest","display","removeAttribute","bookingSelectorPaxToggle","parents","toggleClass","siblings","stop","slideToggle","PricingListingV2","TripExtrasListingV2","bookingSelectorExtrasToggle","excerpt","TripTimesListingV2"],"mappings":"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","file":"1.js","sourcesContent":["import apiFetch from '@wordpress/api-fetch';\nimport { useSelect } from '@wordpress/data';\nimport { applyFilters } from '@wordpress/hooks';\nimport { forwardRef, useEffect, useState } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport moment from 'moment';\nimport DatePicker from \"react-datepicker\";\nimport RRule from \"rrule\";\nimport ErrorBoundry from './ErrorBoundry';\nimport { wpTravelFormat, wpTravelTimeout } from \"./functions\";\n// sub-components\nimport PaxSelector from './sub-components/PaxSelector';\nimport PricingListing from './sub-components/PricingListing';\nimport TripExtrasListing from './sub-components/TripExtrasListing';\nimport TripTimesListing from './sub-components/TripTimesListing';\nimport DatesListing from './sub-components/DatesListing'\n// layout-v2\nimport PaxSelectorV2 from './sub-components/layout-v2/PaxSelectorV2';\nimport PricingListingV2 from './sub-components/layout-v2/PricingListingV2';\nimport TripExtrasListingV2 from './sub-components/layout-v2/TripExtrasListingV2';\nimport TripTimesListingV2 from './sub-components/layout-v2/TripTimesListingV2';\n\nconst _ = lodash\n\nconst storeName = 'WPTravelFrontend/BookingWidget';\n\nconst { currency_symbol: currencySymbol } = _wp_travel\n\nconst Notice = ({ children, className }) => {\n\treturn <div className=\"wp-travel-booking__notice is-info\">\n\t\t<svg id=\"Capa_1\" enableBackground=\"new 0 0 524.235 524.235\" height=\"512\" viewBox=\"0 0 524.235 524.235\" width=\"512\"><path d=\"m262.118 0c-144.53 0-262.118 117.588-262.118 262.118s117.588 262.118 262.118 262.118 262.118-117.588 262.118-262.118-117.589-262.118-262.118-262.118zm17.05 417.639c-12.453 2.076-37.232 7.261-49.815 8.303-10.651.882-20.702-5.215-26.829-13.967-6.143-8.751-7.615-19.95-3.968-29.997l49.547-136.242h-51.515c-.044-28.389 21.25-49.263 48.485-57.274 12.997-3.824 37.212-9.057 49.809-8.255 7.547.48 20.702 5.215 26.829 13.967 6.143 8.751 7.615 19.95 3.968 29.997l-49.547 136.242h51.499c.01 28.356-20.49 52.564-48.463 57.226zm15.714-253.815c-18.096 0-32.765-14.671-32.765-32.765 0-18.096 14.669-32.765 32.765-32.765s32.765 14.669 32.765 32.765c0 18.095-14.668 32.765-32.765 32.765z\"></path></svg>\n\t\t{children}\n\t</div>\n}\n\nconst initialState = {\n\tselectedDate: null,\n\tselectedTripDate: [],\n\tnomineePricings: [],\n\tnomineeTimes: [],\n\tselectedPricing: null,\n\tselectedDateTime: null,\n\tselectedTime: null,\n\trruleAll: {},\n\tpaxCounts: {},\n\ttripExtras: {},\n\tinventory: [],\n\tisLoading: false,\n\texcludedDateTimes: [],\n\tpricingUnavailable: false,\n\ttempExcludeDate: [] // Temp fixes. Just to check exclude date\n}\nconst __i18n = {\n\t..._wp_travel.strings\n}\n\nconst InventoryNotice = ({ inventory }) => {\n\tconst {\n\t\twp_travel_inventory_pax_limit_type,\n\t\twp_travel_inventory_sold_out_action,\n\t\twp_travel_inventory_custom_max_pax,\n\t\twp_travel_inventory_sold_out_message,\n\t\twp_travel_inventory_status_message_format\n\t} = inventory\n\n\tif (wp_travel_inventory_sold_out_action == 'show_sold_out_msg_only') {\n\t\treturn <p className=\"wp-travel-sold-out\">{wp_travel_inventory_sold_out_message}</p>\n\t}\n\tif (wp_travel_inventory_sold_out_action == 'allow_trip_enquiry') {\n\t\treturn <p className=\"wp-travel-sold-out\">\n\t\t\t<a\n\t\t\t\tclassName=\"wp-travel-send-enquiries\"\n\t\t\t\tdata-effect=\"mfp-move-from-top\"\n\t\t\t\thref=\"#wp-travel-enquiries\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\tlet enquiryBtn = document.getElementById('wp-travel-send-enquiries')\n\t\t\t\t\tenquiryBtn && enquiryBtn.click()\n\t\t\t\t}}>\n\t\t\t\t{__i18n.trip_enquiry}\n\t\t\t</a>\n\t\t</p>\n\t}\n\treturn <p>{__i18n.bookings.pricing_not_available}</p>\n}\n\nconst BookingWidget = () => {\n\n\tconst [{ selectedDate,\n\t\tselectedTripDate,\n\t\tselectedTime,\n\t\tnomineePricings,\n\t\tnomineeTimes,\n\t\tselectedPricing,\n\t\tselectedDateTime,\n\t\texcludedDateTimes,\n\t\trruleAll,\n\t\tpaxCounts,\n\t\ttripExtras,\n\t\tinventory,\n\t\tisLoading,\n\t\tpricingUnavailable,\n\t\ttempExcludeDate }\n\t\t, setState] = useState(initialState)\n\n\tconst updateState = data => {\n\t\tsetState(state => ({ ...state, ...data }))\n\t}\n\n\tconst allData = useSelect((select) => {\n\t\treturn select(storeName).getAllStore()\n\t}, []);\n\n\tconst pricings = allData.tripData && allData.tripData.pricings && _.keyBy(allData.tripData.pricings, p => p.id)\n\n\tconst _dates = 'undefined' !== typeof allData.tripData.dates && allData.tripData.dates.length > 0 ? allData.tripData.dates : [];\n\tconst datesById = _.keyBy(_dates, d => d.id)\n\tconst isFixedDeparture = allData.tripData.is_fixed_departure || false\n\tconst duration = allData.tripData.trip_duration.days && parseInt(allData.tripData.trip_duration.days) || 1\n\tconst isTripInventoryEnabled = allData.tripData.inventory && allData.tripData.inventory.enable_trip_inventory === 'yes'\n\tconst _excludedDatesTimes = allData.tripData.excluded_dates_times && allData.tripData.excluded_dates_times.length > 0 && allData.tripData.excluded_dates_times || []\n\tlet excludedDates = []\n\tuseEffect(() => {\n\t\t// if (!selectedDateTime) {\n\t\t\texcludedDates = _excludedDatesTimes\n\t\t\t\t.filter(ed => {\n\t\t\t\t\tif (ed.trip_time.length > 0) {\n\t\t\t\t\t\tlet _times = ed.trip_time.split(',')\n\t\t\t\t\t\tlet _datetimes = _times.map(t => moment(`${ed.start_date} ${t}`).toDate())\n\t\t\t\t\t\tif ( !selectedDateTime || _excludedDatesTimes.includes(moment(ed.start_date).format('YYYY-MM-DD')) ) {\n\t\t\t\t\t\t\texcludedDateTimes.push(_datetimes[0]); // Temp fixes Pushing into direct state is not good.\n\t\t\t\t\t\t\t// updateState({\n\t\t\t\t\t\t\t// \texcludedDateTimes: [ ...excludedDateTimes, _datetimes[0] ]\n\t\t\t\t\t\t\t// })\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t\treturn true\n\t\t\t\t});\n\t\t\t\n\t\t\t// Seperated exclude date.\n\t\t\texcludedDates = excludedDates.map(ed => ed.start_date)\n\t\t\t\tupdateState({\n\t\t\t\t\ttempExcludeDate:excludedDates\n\t\t\t\t});\n\t\t// }\n\t}, [selectedDateTime])\n\n\tuseEffect(() => { // If No Fixed departure set all pricings.\n\t\tif (!isFixedDeparture) {\n\t\t\tupdateState({ nomineePricings: Object.keys(pricings) })\n\t\t\tisLoading && updateState({ isLoading: false })\n\t\t}\n\t}, [selectedDate])\n\n\n\tuseEffect(() => {\n\t\tif (nomineePricings.length === 1) {\n\t\t\thandlePricingSelect(nomineePricings[0])()\n\t\t\tupdateState({\n\t\t\t\tisLoading: true,\n\t\t\t})\n\t\t}\n\t}, [selectedDate])\n\n\tuseEffect(() => {\n\t\tif (!selectedPricing) {\n\t\t\treturn\n\t\t}\n\t\tlet _state = {\n\t\t\tpricingUnavailable: false\n\t\t}\n\t\tlet times = getPricingTripTimes(selectedPricing, selectedTripDate)\n\t\tif (isLoading) { // Prevent looping request.\n\n\t\t\tif (isTripInventoryEnabled && isFixedDeparture) {\n\t\t\t\tsetInventoryData(selectedPricing, selectedDate, times)\n\t\t\t} else {\n\t\t\t\tlet pricing = pricings[selectedPricing]\n\t\t\t\tlet categories = pricing.categories\n\t\t\t\tlet _paxCounts = {}\n\t\t\t\tcategories.forEach(c => {\n\t\t\t\t\t_paxCounts = { ..._paxCounts, [c.id]: parseInt(c.default_pax) || 0 }\n\t\t\t\t})\n\t\n\t\t\t\tlet maxPax = pricing.max_pax || 999\n\t\t\t\tlet _tripExtras = {}\n\t\n\t\t\t\tif (pricing.trip_extras.length > 0) {\n\t\t\t\t\tpricing.trip_extras.forEach(x => {\n\t\t\t\t\t\t_tripExtras = { ..._tripExtras, [x.id]: x.is_required ? 1 : 0 }\n\t\t\t\t\t})\n\t\t\t\t}\n\t\n\t\t\t\t_state = {\n\t\t\t\t\t..._state,\n\t\t\t\t\tisLoading: false,\n\t\t\t\t\tinventory: [{\n\t\t\t\t\t\t'date': moment(selectedDateTime).format('YYYY-MM-DD[T]HH:mm'),\n\t\t\t\t\t\t'pax_available': maxPax,\n\t\t\t\t\t\t'booked_pax': 0,\n\t\t\t\t\t\t'pax_limit': maxPax,\n\t\n\t\t\t\t\t}],\n\t\t\t\t\tnomineeTimes: [],\n\t\t\t\t\ttripExtras: _tripExtras,\n\t\t\t\t\tpaxCounts: _paxCounts\n\t\t\t\t}\n\t\n\t\t\t\tif (times.length > 0) {\n\t\t\t\t\tlet _times = times\n\t\t\t\t\t\t.map(time => {\n\t\t\t\t\t\t\treturn moment(`${selectedDate.toDateString()} ${time}`)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(time => {\n\t\t\t\t\t\t\tif (excludedDateTimes.find(et => moment(et).isSame(time))) {\n\t\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t})\n\t\t\t\t\t_state = {\n\t\t\t\t\t\t..._state,\n\t\t\t\t\t\tselectedDateTime: _times[0].toDate(),\n\t\t\t\t\t\tselectedTime: _times[0].format('HH:mm'),\n\t\t\t\t\t\tnomineeTimes: _times,\n\t\t\t\t\t\tinventory: [{\n\t\t\t\t\t\t\t'date': _times[0].format('YYYY-MM-DD[T]HH:mm'),\n\t\t\t\t\t\t\t'pax_available': maxPax,\n\t\t\t\t\t\t\t'booked_pax': 0,\n\t\t\t\t\t\t\t'pax_limit': maxPax,\n\t\t\t\t\t\t}],\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tupdateState(_state)\n\t}, [selectedPricing, selectedDateTime])\n\n\tuseEffect(() => {\n\t\tif (!isTripInventoryEnabled && selectedPricing) {\n\t\t\tlet pricing = pricings[selectedPricing]\n\t\t\tlet maxPax = pricing.max_pax || 999\n\t\t\tupdateState({\n\t\t\t\tinventory: [{\n\t\t\t\t\t'date': moment(selectedDateTime).format('YYYY-MM-DD[T]HH:mm'),\n\t\t\t\t\t'pax_available': maxPax,\n\t\t\t\t\t'booked_pax': 0,\n\t\t\t\t\t'pax_limit': maxPax,\n\t\t\t\t}]\n\t\t\t})\n\t\t}\n\t}, [selectedDateTime])\n\n\n\tconst generateRRule = (data, startDate) => {\n\t\t// let _startDate = moment(data.start_date)\n\t\tlet ruleArgs = {\n\t\t\tfreq: RRule.DAILY,\n\t\t\tdtstart: startDate.toDate(),\n\t\t\tuntil: startDate.toDate(),\n\t\t};\n\t\tlet selectedYears = data.years ? data.years.split(\",\").filter(year => year != 'every_year').map(year => parseInt(year)) : [];\n\n\t\tif (selectedYears.length > 0 && !selectedYears.includes(startDate.year()))\n\t\t\treturn []\n\n\n\t\tlet selectedMonths = data.months ? data.months.split(\",\").filter(month => month != 'every_month') : [];\n\t\tlet selectedDates = data.date_days ? data.date_days.split(\",\").filter(date => date !== 'every_weekdays' && date !== '') : [];\n\t\tlet selectedDays = data.days ? data.days.split(\",\").filter(day => day !== 'every_date_days' && day !== '') : [];\n\n\t\tif (selectedMonths.length > 0) {\n\t\t\truleArgs.bymonth = selectedMonths.map(m => parseInt(m));\n\t\t}\n\t\tif (selectedDays.length > 0) {\n\t\t\truleArgs.byweekday = selectedDays.map(sd => RRule[sd]);\n\t\t}\n\t\telse if (selectedDates.length > 0) {\n\t\t\truleArgs.bymonthday = selectedDates.map(md => parseInt(md));\n\t\t}\n\n\t\tlet rule = new RRule(ruleArgs);\n\t\treturn rule.all()\n\t}\n\n\t// Date param need to have only Y-M-D date without time.\n\tconst isTourDate = date => {\n\t\tif (moment(date).isBefore(moment(new Date())))\n\t\t\treturn false\n\t\tif (!isFixedDeparture)\n\t\t\treturn true\n\t\tlet curretYear = date.getFullYear();\n\t\tlet currentDate = date.getDate();\n\t\tlet currentMonth = date.getMonth();\n\n\t\tlet startDate = moment(new Date(Date.UTC(curretYear, currentMonth, currentDate, 0, 0, 0))).utc();\n\n\t\tif (tempExcludeDate.includes(startDate.format('YYYY-MM-DD'))) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst _date = _dates.find(data => {\n\t\t\tif (data.is_recurring) {\n\t\t\t\tlet selectedYears = data.years ? data.years.split(\",\").filter(year => year != 'every_year').map(year => parseInt(year)) : [];\n\n\t\t\t\tif (data.end_date && moment(date).toDate().toString().toLowerCase() != 'invalid date' && moment(date).isAfter(moment(data.end_date))) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (data.start_date && moment(date).toDate().toString().toLowerCase() != 'invalid date' && moment(date).isBefore(moment(data.start_date))) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (selectedYears.length > 0 && !selectedYears.includes(startDate.year()))\n\t\t\t\t\treturn false\n\n\t\t\t\tlet dateRules = generateRRule(data, startDate)\n\t\t\t\tif ( ! applyFilters( 'wpTravelRecurringCutofDateFilter', true, dateRules, allData.tripData, date, data )  ) { // @since WP Travel 4.3.1\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn dateRules.find(da => moment(moment(da).format(\"YYYY-MM-DD\")).unix() === moment(moment(date).format('YYYY-MM-DD')).unix()) instanceof Date\n\t\t\t}\n\t\t\tif (data.start_date) {\n\t\t\t\tif ( ! applyFilters( 'wpTravelCutofDateFilter', true, allData.tripData, date, data )  ) { // @since WP Travel 4.3.1\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn moment(date).isSame(moment(data.start_date))\n\t\t\t\t\n\t\t\t}\n\t\t\treturn false\n\t\t})\n\t\treturn _date && 'undefined' !== typeof _date.id\n\t\t// }\n\t}\n\n\tconst dayClicked = ( date, date_id ) => {\n\t\t// console.log('Book now click step 2')\n\t\tif (!isFixedDeparture) {\n\t\t\tupdateState({\n\t\t\t\tpricingUnavailable: false,\n\t\t\t\tselectedDate: date,\n\t\t\t\tselectedDateTime: date,\n\t\t\t\tisLoading: true,\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\tupdateState({\n\t\t\t...initialState,\n\t\t\texcludedDateTimes,\n\t\t\tisLoading: true,\n\t\t\tpricingUnavailable: false,\n\t\t})\n\n\t\tlet _state = {\n\t\t\tselectedDate: date,\n\t\t\tselectedDateTime: date,\n\t\t}\n\n\t\t// @todo use getPricingsByDate function below to get pricing ids/_nomineePricings.\n\t\tlet startDate = moment(new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0))).utc();\n\n\t\tconst _dateIds = _dates // Trip Date IDs matches to selected date.\n\t\t\t.filter(_date => {\n\t\t\t\tif (\n\t\t\t\t\t_date.is_recurring \n\t\t\t\t\t&& ( ( 'undefined' == typeof date_id && 'dates' === tripDateListing ) || 'calendar' === tripDateListing ) ) { // Temp fixes of going inside all loop. date_id is not available in onclick event of recurring date so checking date id to prevent go inside if clicked non recuring date. \n\t\t\t\t\tif (_date.end_date) {\n\t\t\t\t\t\tif (moment(date).toDate().toString().toLowerCase() != 'invalid date' && moment(date).isAfter(moment(_date.end_date))) {\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet dateRules = generateRRule(_date, startDate);\n\t\t\t\t\treturn dateRules.find(da => moment(moment(da).format(\"YYYY-MM-DD\")).unix() === moment(moment(date).format('YYYY-MM-DD')).unix()) instanceof Date\n\t\t\t\t}\n\t\t\t\tif (_date.start_date) {\n\t\t\t\t\treturn moment(date).isSame(moment(_date.start_date))\n\t\t\t\t}\n\t\t\t\treturn moment(_date.start_date).isSame(moment(date))\n\t\t\t}).map(d => d.id)\n\n\t\tlet _nomineePricings = _dateIds.map(id => datesById[id].pricing_ids.split(',').map(id => id.trim()))\n\n\t\t_nomineePricings = _.chain(_nomineePricings).flatten().uniq().value().filter(p => p != '' && typeof pricings[p] !== 'undefined')\n\n\t\tif (_nomineePricings.length <= 0) {\n\t\t\t_state = { ..._state, pricingUnavailable: true }\n\t\t} else {\n\t\t\t_state = { ..._state, nomineePricings: _nomineePricings }\n\t\t}\n\n\t\t_state = { ..._state, selectedTripDate: _dateIds, isLoading: false }\n\n\t\tupdateState(_state)\n\t}\n\n\t// Function used to get pricings in Fixed departure listing.\n\tconst getPricingsByDate = ( date, date_id, returnDateIds ) => {\n\t\tlet startDate = moment(new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0))).utc();\n\n\t\tconst _dateIds = _dates // Trip Date IDs matches to selected date.\n\t\t\t.filter(_date => {\n\t\t\t\tif (\n\t\t\t\t\t_date.is_recurring \n\t\t\t\t\t&& ( ( 'undefined' == typeof date_id && 'dates' === tripDateListing ) || 'calendar' === tripDateListing ) ) { // Temp fixes of going inside all loop. date_id is not available in onclick event of recurring date so checking date id to prevent go inside if clicked non recuring date. \n\t\t\t\t\tif (_date.end_date) {\n\t\t\t\t\t\tif (moment(date).toDate().toString().toLowerCase() != 'invalid date' && moment(date).isAfter(moment(_date.end_date))) {\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet dateRules = generateRRule(_date, startDate);\n\t\t\t\t\treturn dateRules.find(da => moment(moment(da).format(\"YYYY-MM-DD\")).unix() === moment(moment(date).format('YYYY-MM-DD')).unix()) instanceof Date\n\t\t\t\t}\n\t\t\t\tif (_date.start_date) {\n\t\t\t\t\treturn moment(date).isSame(moment(_date.start_date))\n\t\t\t\t\n\t\t\t\t}\n\t\t\t\treturn moment(_date.start_date).isSame(moment(date))\n\t\t\t}).map(d => d.id)\n\n\t\tif ( ! returnDateIds ) { // return pricings\n\t\t\tlet _nomineePricings = _dateIds.map(id => datesById[id].pricing_ids.split(',').map(id => id.trim()))\n\t\t\t_nomineePricings = _.chain(_nomineePricings).flatten().uniq().value().filter(p => p != '' && typeof pricings[p] !== 'undefined')\n\t\t\treturn _nomineePricings;\n\t\t}\n\t\treturn _dateIds;\n\t}\n\n\t// For fixed departure listing.\n\tconst handleFixedDeparturePricingSelect = ( date, date_id, pricingId ) => {\n\t\tif (!isFixedDeparture) {\n\t\t\tupdateState({\n\t\t\t\tpricingUnavailable: false,\n\t\t\t\tselectedDate: date,\n\t\t\t\tselectedDateTime: date,\n\t\t\t\tisLoading: true,\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\tupdateState({\n\t\t\t...initialState,\n\t\t\texcludedDateTimes,\n\t\t\tisLoading: true,\n\t\t\tpricingUnavailable: false,\n\t\t})\n\n\t\tlet _state = {\n\t\t\tselectedDate: date,\n\t\t\tselectedDateTime: date,\n\t\t}\n\n\t\tlet _dateIds = getPricingsByDate( date, date_id, true );\n\t\tlet _nomineePricings = _dateIds.map(id => datesById[id].pricing_ids.split(',').map(id => id.trim()))\n\t\t\t_nomineePricings = _.chain(_nomineePricings).flatten().uniq().value().filter(p => p != '' && typeof pricings[p] !== 'undefined')\n\t\tif (_nomineePricings.length <= 0) {\n\t\t\t_state = { ..._state, pricingUnavailable: true }\n\t\t} else {\n\t\t\t_state = { ..._state, nomineePricings: _nomineePricings }\n\t\t}\n\n\t\t_state = { ..._state, selectedTripDate: _dateIds, isLoading: true, selectedPricing:pricingId }\n\t\tupdateState(_state)\n\t\t// end of date update in state\n\t}\n\n\tconst handleTimeClick = time => () => {\n\t\tupdateState({ selectedDateTime: time.toDate(), selectedTime: time.format('HH:mm') })\n\t}\n\n\tconst handlePaxChange = (id, value) => e => {\n\t\tlet pricing = pricings[selectedPricing]\n\t\tlet category = pricing.categories.find(c => c.id === id)\n\t\tlet count = paxCounts[id] + value < 0 ? 0 : paxCounts[id] + value\n\t\t// if (parseInt(category.default_pax) > count)\n\t\t// \tcount = parseInt(category.default_pax)\n\n\t\tlet _inventory = inventory.find(i => i.date === moment(selectedDateTime).format('YYYY-MM-DD[T]HH:mm'))\n\t\tlet maxPax = _inventory && _inventory.pax_available\n\t\t// }\n\t\tif (maxPax >= 1) {\n\t\t\tlet _totalPax = _.size(paxCounts) > 0 && Object.values(paxCounts).reduce((acc, curr) => acc + curr) || 0\n\t\t\tif (_totalPax + value > parseInt(maxPax)) {\n\t\t\t\tif (e.target.parentElement.querySelector('.error'))\n\t\t\t\t\treturn\n\t\t\t\tlet em = document.createElement('em')\n\t\t\t\tem.classList.add('error')\n\t\t\t\tem.textContent = __i18n.bookings.max_pax_exceeded\n\t\t\t\te.target.parentElement.appendChild(em)\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tem.remove()\n\t\t\t\t}, 1000)\n\t\t\t\treturn\n\t\t\t} else {\n\t\t\t\te.target.parentElement.querySelector('.error') && e.target.parentElement.querySelector('.error').remove()\n\t\t\t}\n\t\t}\n\n\t\tupdateState({ paxCounts: { ...paxCounts, [id]: count } })\n\t}\n\n\tconst getCartTotal = (withExtras) => {\n\t\tlet total = 0;\n\t\tlet txTotal = 0;\n\n\t\tlet tpax = 0\n\t\ttotal = _.size(paxCounts) > 0 && Object.entries(paxCounts).map(([i, count]) => {\n\t\t\ttpax += parseInt(count)\n\t\t\treturn count > 0 && getCategoryPrice(i, count) || 0 // i is category id here.\n\t\t\t// return parseFloat(price) * count\n\t\t}).reduce((acc, curr) => acc + curr) || 0\n\t\tif (!withExtras || tpax <= 0) {\n\t\t\treturn total\n\t\t}\n\t\tlet _tripExtras = selectedPricing && _.keyBy(pricings[selectedPricing].trip_extras, tx => tx.id)\n\t\ttxTotal = _.size(tripExtras) > 0 && Object.entries(tripExtras).map(([i, count]) => {\n\t\t\tlet tx = _tripExtras[i]\n\t\t\tif (!tx || typeof tx.tour_extras_metas == 'undefined') {\n\t\t\t\treturn 0\n\t\t\t}\n\t\t\tlet price = tx.is_sale && tx.tour_extras_metas.extras_item_sale_price || tx.tour_extras_metas.extras_item_price\n\t\t\treturn parseFloat(price) * count\n\t\t}).reduce((acc, curr) => acc + curr) || 0\n\t\treturn total + txTotal\n\t}\n\n\tconst addToCart = () => {\n\t\tlet data = {\n\t\t\ttrip_id: allData.tripData.id,\n\t\t\tarrival_date: moment(selectedDateTime).format('YYYY-MM-DD'),\n\t\t\tpricing_id: selectedPricing,\n\t\t\tpax: paxCounts,\n\t\t\tcategory_pax: paxCounts,\n\t\t\ttrip_price: getCartTotal(),\n\t\t}\n\n\t\tif (selectedTime)\n\t\t\tdata.trip_time = moment(selectedDateTime).format('HH:mm')\n\n\t\tlet _txs = {}\n\t\tObject.entries(tripExtras).forEach(([key, value]) => {\n\t\t\tif (value > 0) {\n\t\t\t\t_txs = { ..._txs, [key]: value }\n\t\t\t}\n\t\t})\n\n\t\tif (_.size(_txs) > 0) {\n\t\t\tdata.wp_travel_trip_extras = {\n\t\t\t\tid: Object.keys(_txs),\n\t\t\t\tqty: Object.values(_txs)\n\t\t\t}\n\t\t}\n\t\twpTravelTimeout(\n\t\t\tapiFetch({\n\t\t\t\turl: `${wp_travel.ajaxUrl}?action=wp_travel_add_to_cart&_nonce=${_wp_travel._nonce}`,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata\n\t\t\t})\n\t\t\t\t.then(res => {\n\t\t\t\t\tif (true === res.success && 'WP_TRAVEL_ADDED_TO_CART' === res.data.code) {\n\t\t\t\t\t\tif ( wp_travel.isEnabledCartPage ) {\n\t\t\t\t\t\t\tlocation.href = wp_travel.cartUrl; // This may include cart or checkout page url.\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\tlocation.href = wp_travel.checkoutUrl; // [only checkout page url]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}), 1000)\n\t\t\t.catch(error => {\n\t\t\t\talert('[X] Request Timeout!')\n\t\t\t})\n\t}\n\n\tconst getCategoryPrice = (categoryId, count) => {\n\t\tlet pricing = pricings[selectedPricing]\n\t\tlet category = pricing.categories.find(c => c.id == categoryId)\n\t\tif (!category) return\n\t\tlet price = category && category.is_sale ? category.sale_price : category.regular_price\n\n\t\tif (category.has_group_price && category.group_prices.length > 0) { // If has group price/discount.\n\t\t\t// hasGroupPrice = true\n\t\t\tlet groupPrices = _.orderBy(category.group_prices, gp => parseInt(gp.max_pax))\n\t\t\tlet group_price = groupPrices.find(gp => parseInt(gp.min_pax) <= count && parseInt(gp.max_pax) >= count)\n\t\t\tif (group_price && group_price.price) {\n\t\t\t\tprice = 'group' === category.price_per ? count > 0 && parseFloat(group_price.price) || 0 : parseFloat(group_price.price) * count\n\t\t\t} else {\n\t\t\t\tprice = 'group' === category.price_per ? count > 0 && parseFloat(price) || 0 : parseFloat(price) * count\n\t\t\t}\n\t\t} else {\n\t\t\tprice = 'group' === category.price_per ? count > 0 && parseFloat(price) || 0 : parseFloat(price) * count\n\t\t}\n\t\treturn price || 0\n\t}\n\n\tconst getPricingTripTimes = (pricingId, selectedTripdates) => {\n\t\tlet trip_time = selectedTripdates.map(td => {\n\t\t\tlet date = datesById[td]\n\t\t\tif (date.pricing_ids && date.pricing_ids.split(',').includes(pricingId)) {\n\t\t\t\tlet times = date.trip_time && date.trip_time.split(',') || []\n\t\t\t\ttimes = applyFilters( 'wpTravelCutofTimeFilter', times, allData.tripData, selectedDateTime )  // @since WP Travel 4.3.1\n\t\t\t\treturn times;\n\t\t\t}\n\t\t\treturn []\n\t\t})\n\t\treturn _.chain(trip_time).flatten().uniq().value()\n\n\t}\n\n\tconst setInventoryData = (pricingId, date, times) => {\n\t\tapiFetch({\n\t\t\turl: `${_wp_travel.ajax_url}?action=wp_travel_get_inventory&pricing_id=${pricingId}&trip_id=${allData.tripData.id}&selected_date=${moment(date).format('YYYY-MM-DD')}&times=${times.join()}&_nonce=${_wp_travel._nonce}`\n\t\t})\n\t\t\t.then(res => {\n\t\t\t\tif (res.success && res.data.code === 'WP_TRAVEL_INVENTORY_INFO') {\n\t\t\t\t\tif (res.data.inventory.length <= 0) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tlet _times = res.data.inventory.filter(inventory => {\n\t\t\t\t\t\tif (inventory.pax_available > 0) {\n\t\t\t\t\t\t\tif (excludedDateTimes.find(et => moment(et).isSame(moment(inventory.date)))) {\n\t\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}).map(inventory => {\n\t\t\t\t\t\treturn moment(inventory.date)\n\t\t\t\t\t})\n\t\t\t\t\tlet _state = {\n\t\t\t\t\t\tisLoading: false\n\t\t\t\t\t}\n\n\t\t\t\t\tlet _tripExtras = {}\n\t\t\t\t\tlet pricing = pricings[pricingId]\n\t\t\t\t\tif (pricing.trip_extras.length > 0) {\n\t\t\t\t\t\tpricing.trip_extras.forEach(x => {\n\t\t\t\t\t\t\t_tripExtras = { ..._tripExtras, [x.id]: x.is_required ? 1 : 0 }\n\t\t\t\t\t\t})\n\t\t\t\t\t\t_state = { ..._state, tripExtras: _tripExtras }\n\t\t\t\t\t}\n\n\t\t\t\t\tlet categories = pricing.categories\n\t\t\t\t\tlet _paxCounts = {}\n\t\t\t\t\tcategories.forEach(c => {\n\t\t\t\t\t\t_paxCounts = { ..._paxCounts, [c.id]: parseInt(c.default_pax) || 0 }\n\t\t\t\t\t})\n\t\t\t\t\t_state = { ..._state, paxCounts: _paxCounts }\n\n\t\t\t\t\t_state = _times.length > 0 && { ..._state, selectedDateTime: _times[0].toDate(), selectedTime: _times[0].format('HH:mm') } || _state\n\t\t\t\t\t_state = times.length > 0 && { ..._state, nomineeTimes: _times } || _state\n\t\t\t\t\t// if (excludedDateTimes.length > 0 && _times.length <= 0) { // Why??\n\t\t\t\t\t// \t_state = { ..._state, pricingUnavailable: true }\n\t\t\t\t\t// }\n\t\t\t\t\tif (_times.length <= 0) { // Why??\n\t\t\t\t\t\t_state = { ..._state, pricingUnavailable: true }\n\t\t\t\t\t}\n\t\t\t\t\t_state = res.data.inventory.length > 0 && { ..._state, inventory: res.data.inventory } || { ..._state, pricingUnavailable: true }\n\t\t\t\t\tupdateState(_state)\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tconst handlePricingSelect = id => () => {\n\t\t\n\t\tlet _state = {}\n\t\t_state.isLoading = true\n\t\t_state.selectedPricing = id\n\t\tupdateState(_state)\n\t}\n\n\tuseEffect(() => {\n\t\tjQuery('.wti__selector-item.active').find('.wti__selector-content-wrapper').slideDown();\n\t}),[];\n\n\tconst DatePickerBtn = forwardRef(({ value, onClick }, ref) => (\n\t\t!_wp_travel.itinerary_v2 ? \n\t\t<button className=\"wp-travel-date-picker-btn\" onClick={onClick}>\n\t\t\t{selectedDate ? !isFixedDeparture && `${moment(selectedDate).format('MMM D, YYYY')} - ${moment(selectedDate).add(duration - 1, 'days').format('MMM D, YYYY')}` || moment(selectedDate).format('MMM D, YYYY') : __i18n.bookings.date_select}\n\t\t\t<span>\n\t\t\t\t<svg enableBackground=\"new 0 0 512 512\" height=\"512\" viewBox=\"0 0 512 512\" width=\"512\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"m446 40h-46v-24c0-8.836-7.163-16-16-16s-16 7.164-16 16v24h-224v-24c0-8.836-7.163-16-16-16s-16 7.164-16 16v24h-46c-36.393 0-66 29.607-66 66v340c0 36.393 29.607 66 66 66h380c36.393 0 66-29.607 66-66v-340c0-36.393-29.607-66-66-66zm-380 32h46v16c0 8.836 7.163 16 16 16s16-7.164 16-16v-16h224v16c0 8.836 7.163 16 16 16s16-7.164 16-16v-16h46c18.748 0 34 15.252 34 34v38h-448v-38c0-18.748 15.252-34 34-34zm380 408h-380c-18.748 0-34-15.252-34-34v-270h448v270c0 18.748-15.252 34-34 34z\"></path></g></svg>\n\t\t\t</span>\n\t\t</button>\n\t\t:\n\t\t<button className=\"wp-travel-date-picker-btn\" onClick={onClick}>\n\t\t\t{selectedDate ? !isFixedDeparture && `${moment(selectedDate).format('MMM D, YYYY')} - ${moment(selectedDate).add(duration - 1, 'days').format('MMM D, YYYY')}` || moment(selectedDate).format('MMM D, YYYY') : __i18n.bookings.date_select}\n\t\t\t<span>\n\t\t\t\t<i className=\"far fa-calendar-alt\"></i>\n\t\t\t</span>\n\t\t</button>\n\t))\n\n\tlet _mindate = _.chain(_dates).sortBy(d => moment(d.start_date).unix()).value() || []\n\t_mindate = _mindate.find(md => moment(md.start_date).isAfter(moment(new Date())) || moment(md.start_date).isSame(moment(new Date())))\n\n\tlet minDate = _mindate && moment(_mindate.start_date).toDate() || new Date();\n\tlet maxDate = new Date( new Date().setFullYear(new Date().getFullYear() + 10 ));\n\t\n\tlet params = {\n\t\tshowMonthDropdown: true,\n\t\tcustomInput: <DatePickerBtn isFixedDeparture={isFixedDeparture} duration={duration} selectedDate={selectedDate} />,\n\t\tshowYearDropdown: true,\n\t\tdropdownMode: \"select\",\n\t\tminDate: minDate,\n\t\tmaxDate: maxDate,\n\t\tonChange: dayClicked,\n\t\tfilterDate: isTourDate\n\t}\n\tif (!isFixedDeparture) {\n\t\tdelete params.filterDate\n\t\tparams.minDate = new Date()\n\t\tparams.startDate = selectedDate\n\t\tparams.endDate = moment(selectedDate).add(duration - 1, 'days').toDate()\n\t}\n\n\tlet totalPax = _.size(paxCounts) > 0 && Object.values(paxCounts).reduce((acc, curr) => acc + curr) || 0\n\tlet minPaxToBook = selectedPricing && pricings[selectedPricing].min_pax && parseInt(pricings[selectedPricing].min_pax) || 1\n\tlet activeInventory = inventory.find(i => i.date === moment(selectedDateTime).format('YYYY-MM-DD[T]HH:mm'))\n\tlet maxPaxToBook = activeInventory && parseInt(activeInventory.pax_available)\n\tconst tripDateListing = _wp_travel.trip_date_listing\n\t// Only used in fixed departure date listing.\n\tlet paxSelectorData ={\n\t\tpricing: pricings[selectedPricing] || null,\n\t\tonPaxChange:handlePaxChange,\n\t\tcounts:paxCounts,\n\t\tinventory:inventory,\n\t\tselectedPricingId:selectedPricing, // Additional Data.\n\t\tselectedDateIds:selectedTripDate, // Additional Data.\n\t\tselectedDateTime:selectedDateTime, // Additional Data.  for pax picker and time picker\n\t\tonTimeSelect:handleTimeClick, // For time picker\n\t\tnomineeTimes:nomineeTimes, // For time picker\n\t\ttotalPax:totalPax, // For extras.\n\t\ttripExtras:tripExtras, // For extras.\n\t\tupdateState:updateState // For extras.\n\t}\n\tconsole.log(pricings[selectedPricing]);\n\treturn <>\n\t\t{\n\t\t\t!_wp_travel.itinerary_v2 ?\n\t\t\t<>\n\t\t\t<div className=\"wp-travel-booking__header\">\n\t\t\t\t<h3>{__i18n.booking_tab_content_label}</h3>\n\t\t\t\t{selectedDate && <button onClick={() => {\n\t\t\t\t\tlet _initialState = Object.assign(initialState)\n\t\t\t\t\tif (!isFixedDeparture)\n\t\t\t\t\t\tdelete _initialState.nomineePricings\n\t\t\t\t\tupdateState(_initialState)\n\t\t\t\t}}>\n\t\t\t\t\t<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" x={0} y={0} viewBox=\"0 0 36.9 41.7\"><path\n\t\t\t\t\t\td=\"M35.8,17.1l-2.8,1c0.6,1.7,0.9,3.4,0.9,5.2c0,8.5-6.9,15.4-15.4,15.4C9.9,38.7,3,31.8,3,23.3C3,14.8,9.9,7.8,18.4,7.8\n\t\t\t\t\t\tc1.3,0,2.6,0.2,3.9,0.5l-2.8,3l2.2,2L25,9.9l2.3-2.4L26,4.4L24.2,0l-2.8,1.1l1.8,4.3c-1.5-0.4-3.1-0.6-4.7-0.6\n\t\t\t\t\t\tC8.3,4.8,0,13.1,0,23.3c0,10.2,8.3,18.4,18.4,18.4c10.2,0,18.4-8.3,18.4-18.4C36.9,21.2,36.5,19.1,35.8,17.1z\">\n\t\t\t\t\t</path>\n\t\t\t\t\t</svg>\n\t\t\t\t\t{__i18n.bookings.booking_tab_clear_all}</button>}\n\t\t\t</div>\n\t\t\t\t{<>\n\t\t\t\t\t{\n\t\t\t\t\t\tisFixedDeparture && 'dates' === tripDateListing && \n\t\t\t\t\t\t\t<div className=\"wp-travel-booking__content-wrapper\">\n\t\t\t\t\t\t\t\t<DatesListing {...{ dates: datesById, onDateClick: dayClicked, isTourDate, getPricingsByDate, allData, onFixedDeparturePricingSelect:handleFixedDeparturePricingSelect, paxSelectorData, getPricingTripTimes:getPricingTripTimes }} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t||\n\t\t\t\t\t\t<div className=\"wp-travel-booking__datepicker-wrapper\">\n\t\t\t\t\t\t\t<DatePicker {...params} />\n\t\t\t\t\t\t\t{!selectedDateTime && <p>{__i18n.bookings.date_select_to_view_options}</p> || null}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</>}\n\t\t\t{isFixedDeparture && 'dates' === tripDateListing && selectedDateTime &&\n\t\t\t\t<p>Trip Date: <span>{moment(selectedDateTime).format('YYYY-MM-DD')}</span></p>\n\t\t\t}\n\n\t\t\t{\n\t\t\t\tselectedDateTime && <div className=\"wp-travel-booking__pricing-wrapper\">\n\t\t\t\t\t{\n\t\t\t\t\t\tnomineePricings.length > 1 && <ErrorBoundry>\n\t\t\t\t\t\t\t<PricingListing\n\t\t\t\t\t\t\t\tselected={selectedPricing}\n\t\t\t\t\t\t\t\toptions={nomineePricings}\n\t\t\t\t\t\t\t\tonPricingSelect={handlePricingSelect}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ErrorBoundry>\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\t!pricingUnavailable && nomineeTimes.length > 0 && <ErrorBoundry>\n\t\t\t\t\t\t\t<TripTimesListing\n\t\t\t\t\t\t\t\tselected={selectedDateTime}\n\t\t\t\t\t\t\t\tonTimeSelect={handleTimeClick}\n\t\t\t\t\t\t\t\toptions={nomineeTimes}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ErrorBoundry>\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\t!pricingUnavailable && selectedPricing && inventory.find(i => i.pax_available > 0) && <ErrorBoundry>\n\t\t\t\t\t\t\t<PaxSelector\n\t\t\t\t\t\t\t\tpricing={pricings[selectedPricing] || null}\n\t\t\t\t\t\t\t\tonPaxChange={handlePaxChange}\n\t\t\t\t\t\t\t\tcounts={paxCounts}\n\t\t\t\t\t\t\t\tinventory={inventory}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ErrorBoundry>\n\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\t!pricingUnavailable && totalPax > 0 && _.size(pricings[selectedPricing].trip_extras) > 0 && <ErrorBoundry>\n\t\t\t\t\t\t\t<TripExtrasListing\n\t\t\t\t\t\t\t\toptions={pricings[selectedPricing].trip_extras}\n\t\t\t\t\t\t\t\tonChange={(id, value) => () => updateState({ tripExtras: { ...tripExtras, [id]: parseInt(value) } })}\n\t\t\t\t\t\t\t\tcounts={tripExtras}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ErrorBoundry>\n\t\t\t\t\t}\n\t\t\t\t\t{pricingUnavailable && <Notice>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tallData\n\t\t\t\t\t\t\t&& allData.tripData.inventory\n\t\t\t\t\t\t\t&& allData.tripData.inventory.enable_trip_inventory == 'yes'\n\t\t\t\t\t\t\t&& <InventoryNotice inventory={allData.tripData.inventory} />\n\t\t\t\t\t\t}\n\t\t\t\t\t</Notice>\n\t\t\t\t\t}\n\t\t\t\t\t{isLoading && <div id=\"loader\">\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t{selectedDate && selectedPricing && \n\t\t\t\t<div className=\"wp-travel-booking__panel-bottom\">\n\t\t\t\t\t{\n\t\t\t\t\t'dates' === tripDateListing && <div className=\"left-info\" >\n\t\t\t\t\t\t{selectedPricing && <p><strong>Pricing</strong>: {pricings[selectedPricing].title}</p>}\n\t\t\t\t\t\t{selectedDateTime && <p><strong>Trip Date</strong>: <span>{moment(selectedDateTime).format(_wp_travel.date_format_moment)}</span></p>}\n\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t\t<div className=\"right-info\" >\n\t\t\t\t\t\t<p>{__i18n.bookings.booking_tab_cart_total}<strong dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCartTotal(true)) }}></strong></p>\n\t\t\t\t\t\t<button disabled={totalPax < minPaxToBook || totalPax > maxPaxToBook} onClick={addToCart} className=\"wp-travel-book\">{__i18n.bookings.booking_tab_booking_btn_label}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>}\n\t\t\t</>\n\t\t\t: // For new layout. @since v4.4.6\n\t\t\t<>\n\t\t\t\t{/* <h3>{__i18n.booking_tab_content_label}</h3> */}\n\t\t\t\t{selectedDate && <div className=\"wti_booking_clear_btn\"><button className=\"wti_clear_all\" onClick={() => {\n\t\t\t\t\tlet _initialState = Object.assign(initialState)\n\t\t\t\t\tif (!isFixedDeparture)\n\t\t\t\t\t\tdelete _initialState.nomineePricings\n\t\t\t\t\tupdateState(_initialState)\n\t\t\t\t}}>\n\t\t\t\t\t<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" x={0} y={0} viewBox=\"0 0 36.9 41.7\"><path\n\t\t\t\t\t\td=\"M35.8,17.1l-2.8,1c0.6,1.7,0.9,3.4,0.9,5.2c0,8.5-6.9,15.4-15.4,15.4C9.9,38.7,3,31.8,3,23.3C3,14.8,9.9,7.8,18.4,7.8\n\t\t\t\t\t\tc1.3,0,2.6,0.2,3.9,0.5l-2.8,3l2.2,2L25,9.9l2.3-2.4L26,4.4L24.2,0l-2.8,1.1l1.8,4.3c-1.5-0.4-3.1-0.6-4.7-0.6\n\t\t\t\t\t\tC8.3,4.8,0,13.1,0,23.3c0,10.2,8.3,18.4,18.4,18.4c10.2,0,18.4-8.3,18.4-18.4C36.9,21.2,36.5,19.1,35.8,17.1z\">\n\t\t\t\t\t</path>\n\t\t\t\t\t</svg>\n\t\t\t\t{__i18n.bookings.booking_tab_clear_all}</button></div>}\n\t\t\t\t<div className=\"wti__booking-date-picker\">\n\t\t\t\t\t<DatePicker {...params} />\n\t\t\t\t</div>\n\t\t\t\t{\n\t\t\t\t\tselectedDateTime && <div className=\"wti__selectors\">\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnomineePricings.length > 1 && <ErrorBoundry>\n\t\t\t\t\t\t\t\t<PricingListingV2\n\t\t\t\t\t\t\t\t\tselected={selectedPricing}\n\t\t\t\t\t\t\t\t\toptions={nomineePricings}\n\t\t\t\t\t\t\t\t\tonPricingSelect={handlePricingSelect}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</ErrorBoundry>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t!pricingUnavailable && nomineeTimes.length > 0 && <ErrorBoundry>\n\t\t\t\t\t\t\t\t<TripTimesListingV2\n\t\t\t\t\t\t\t\t\tselected={selectedDateTime}\n\t\t\t\t\t\t\t\t\tonTimeSelect={handleTimeClick}\n\t\t\t\t\t\t\t\t\toptions={nomineeTimes}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</ErrorBoundry>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t!pricingUnavailable && selectedPricing && inventory.find(i => i.pax_available > 0) && <ErrorBoundry>\n\t\t\t\t\t\t\t\t<PaxSelectorV2\n\t\t\t\t\t\t\t\t\tpricing={pricings[selectedPricing] || null}\n\t\t\t\t\t\t\t\t\tonPaxChange={handlePaxChange}\n\t\t\t\t\t\t\t\t\tcounts={paxCounts}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</ErrorBoundry>\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t!pricingUnavailable && totalPax > 0 && _.size(pricings[selectedPricing].trip_extras) > 0 && <ErrorBoundry>\n\t\t\t\t\t\t\t\t<TripExtrasListingV2\n\t\t\t\t\t\t\t\t\toptions={pricings[selectedPricing].trip_extras}\n\t\t\t\t\t\t\t\t\tonChange={(id, value) => () => updateState({ tripExtras: { ...tripExtras, [id]: parseInt(value) } })}\n\t\t\t\t\t\t\t\t\tcounts={tripExtras}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</ErrorBoundry>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{pricingUnavailable && <Notice>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tallData\n\t\t\t\t\t\t\t\t&& allData.tripData.inventory\n\t\t\t\t\t\t\t\t&& allData.tripData.inventory.enable_trip_inventory == 'yes'\n\t\t\t\t\t\t\t\t&& <InventoryNotice inventory={allData.tripData.inventory} />\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Notice>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{isLoading && <div id=\"loader\">\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t</div>\n\t\t\t}\n\t\t\t{selectedDate && selectedPricing && <div className=\"wti__booking-total-amount\">\n\t\t\t\t<h3 className=\"amount-figure\"><span>{__i18n.bookings.booking_tab_cart_total}</span><strong className=\"total-amount\" dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCartTotal(true)) }}></strong></h3>\n\t\t\t</div>\n\t\t\t}\n\t\t\t{selectedDate && selectedPricing &&\n\t\t\t\t<button disabled={totalPax < minPaxToBook || totalPax > maxPaxToBook} onClick={addToCart} className=\"wti__book-now-button\">{__i18n.bookings.booking_tab_booking_btn_label}</button>\n\t\t\t}\n\t\t\t</>\n\t\t}\n\t</>;\n}\n\nexport default BookingWidget\n","const {\n    currency,\n    currency_symbol: _currencySymbol,\n    currency_position: currencyPosition,\n    decimal_separator: decimalSeparator,\n    number_of_decimals: _toFixed,\n    thousand_separator: kiloSeparator\n} = _wp_travel\n\nconst wpTravelFormat = (_num, style = 'currency') => {\n    let regEx = new RegExp(`\\\\d(?=(\\\\d{3})+\\\\${decimalSeparator})`, 'gi')\n    let replaceWith = `$&${kiloSeparator}`\n\n    let _formattedNum = parseFloat(_num).toFixed(_toFixed).replace(/\\./,decimalSeparator).replace(regEx, replaceWith)\n    // _formattedNum = String(_formattedNum).replace(/\\./, ',')\n    if(style == 'decimal') {\n        return _formattedNum\n    }\n    let positions = {\n        'left': `${_currencySymbol}<span>${_formattedNum}</span>`,\n        'left_with_space': `${_currencySymbol} <span>${_formattedNum}</span>`,\n        'right': `<span>${_formattedNum}</span>${_currencySymbol}`,\n        'right_with_space': `<span>${_formattedNum}</span> ${_currencySymbol}`,\n    }\n    return positions[currencyPosition]\n}\n\n// For group discount price display on frontend.\nconst wpTravelFormatV2 = (_num, style = 'currency') => {\n    let regEx = new RegExp(`\\\\d(?=(\\\\d{3})+\\\\${decimalSeparator})`, 'gi')\n    let replaceWith = `$&${kiloSeparator}`\n\n    let _formattedNum = parseFloat(_num).toFixed(_toFixed).replace(/\\./,decimalSeparator).replace(regEx, replaceWith)\n    // _formattedNum = String(_formattedNum).replace(/\\./, ',')\n    if(style == 'decimal') {\n        return _formattedNum\n    }\n    let positions = {\n        'left': `${_currencySymbol}${_formattedNum}`,\n        'left_with_space': `${_currencySymbol} ${_formattedNum}`,\n        'right': `${_formattedNum}${_currencySymbol}`,\n        'right_with_space': `${_formattedNum}${_currencySymbol}`,\n    }\n    return positions[currencyPosition]\n}\n\nconst wpTravelTimeout = (promise, ms = 10000) => {\n    return new Promise((resolve, reject) => {\n        setTimeout(() => {\n            reject(new Error('[X] Timeout!'))\n        }, 1000)\n        resolve(promise.then())\n    })\n}\n\nconst wpTravelPHPtoMomentDateFormat = (dateFormat) => {\n    const formats = {\n        \n    }\n}\nexport { wpTravelFormat, wpTravelFormatV2, wpTravelTimeout }\n","import moment from 'moment'\nimport { RRule, RRuleSet, rrulestr } from 'rrule'\nimport { useMemo, useState, useRef, useEffect } from '@wordpress/element'\nimport { PanelBody, PanelRow, Disabled, RadioControl, CheckboxControl } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n'\nconst _ = lodash\n\nimport ErrorBoundry from '../ErrorBoundry';\n\nimport PaxSelector from './PaxSelector';\nimport TripTimesListing from './TripTimesListing';\nimport TripExtrasListing from './TripExtrasListing';\n\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconsole.log(__i18n);\nconst datePerPage = 5\nconst generateRRule = rruleArgs => {\n    const rruleSet = new RRuleSet();\n    rruleSet.rrule(\n        new RRule(rruleArgs)\n    );\n    let rule = new RRule(rruleArgs);\n    return rule.all()\n}\n\nconst generateRRUleArgs = data => {\n    let startDate = data.start_date && new Date(data.start_date) || new Date();\n    let currentDate = new Date();\n\n    let rruleStartDate = currentDate < startDate ? startDate : currentDate;\n\n    let ruleArgs = {\n        freq: RRule.DAILY,\n        count: datePerPage,\n        dtstart: new Date(Date.UTC(rruleStartDate.getFullYear(), rruleStartDate.getMonth(), rruleStartDate.getDate(), 0, 0, 0)),\n    };\n    if ( data.end_date && '0000-00-00' != data.end_date ) { // if has end date.\n        let endDate = new Date(data.end_date)\n        ruleArgs.until = endDate\n    }\n    rruleStartDate = moment( rruleStartDate ).utc();\n    let selectedYears = data.years ? data.years.split(\",\").filter(year => year != 'every_year').map(year => parseInt(year)) : [];\n    \n    if (selectedYears.length > 0 && !selectedYears.includes(rruleStartDate.year()))\n        return []\n\n\n    let selectedMonths = data.months ? data.months.split(\",\").filter(month => month != 'every_month') : [];\n    let selectedDates = data.date_days ? data.date_days.split(\",\").filter(date => date !== 'every_weekdays' && date !== '') : [];\n    let selectedDays = data.days ? data.days.split(\",\").filter(day => day !== 'every_date_days' && day !== '') : [];\n\n    if (selectedMonths.length > 0) {\n        ruleArgs.bymonth = selectedMonths.map(m => parseInt(m));\n    }\n    if (selectedDays.length > 0) {\n        ruleArgs.byweekday = selectedDays.map(sd => RRule[sd]);\n    }\n    else if (selectedDates.length > 0) {\n        ruleArgs.bymonthday = selectedDates.map(md => parseInt(md));\n    }\n\n    return ruleArgs\n}\n\nconst RecurringDates = ({ data, onDateClick, isTourDate, getPricingsByDate, onFixedDeparturePricingSelect, allData, paxSelectorData }) => {\n   \n    const [dates, setRecurringDates] = useState([])\n    const [activeRecurringDates, setActiveRecurringDates] = useState([])\n    const [rruleArgs, setRRuleArgs] = useState(null)\n    const [showRecurringDates, showRecurringDatesToggle] = useState(false)\n    const [selectedDate, setSelectedDate] = useState(null)\n    const [{ activePage, datesPerPage, pagesCount }, setPagination] = useState({\n        activePage: 0,\n        datesPerPage: datePerPage,\n        pagesCount: 0\n    })\n    useEffect(() => {\n        if (!rruleArgs) {\n            setRRuleArgs(generateRRUleArgs(data))\n        }\n    }, [data])\n\n    useEffect(() => {\n        if (rruleArgs) {\n            let _dates = generateRRule(rruleArgs)\n            setRecurringDates(_dates)\n            setActiveRecurringDates(_dates)\n            setPagination(state => ({ ...state, activePage: 1, pagesCount: 1 }))\n        }\n    }, [rruleArgs])\n    const nextStartDate = dates.length > 0 && moment(dates[dates.length - 1]).add(1, 'days').toDate()\n\n    const handleDateClick = _date => e => {\n        // e.target.disabled = true\n        showRecurringDatesToggle(!showRecurringDates)\n        setSelectedDate(_date)\n        onDateClick(_date)() // onDateClick returns a function.\n    }\n    let pricings = allData.tripData && allData.tripData.pricings && _.keyBy(allData.tripData.pricings, p => p.id); // All Pricings.\n    const handleFixedDeparturePricingClick = ( date, date_id, pricingId ) => e => {\n        if (typeof onFixedDeparturePricingSelect === 'function') {\n            onFixedDeparturePricingSelect(moment(date).toDate(), date_id, pricingId )()\n        }\n    }\n\n    const loadMoreDates = page => () => {\n        let start = page < 0 ? (activePage - 2) * datesPerPage : activePage * datesPerPage\n        let end = start + datesPerPage\n        let _dates = []\n        let pagination = {}\n        if (dates.slice(start, end).length > 0) {\n            _dates = dates.slice(start, end)\n        } else {\n            let _rruleArgs = {\n                ...rruleArgs,\n                dtstart: nextStartDate\n            }\n            _dates = generateRRule(_rruleArgs)\n            setRecurringDates([...dates, ..._dates])\n            pagination.pagesCount = pagesCount + 1\n        }\n        if (_dates.length > 0) {\n            setActiveRecurringDates(_dates)\n            pagination.activePage = activePage + page\n            setPagination(state => ({ ...state, ...pagination }))\n        }\n    }\n    return <>\n    <tbody className=\"tbody-table\">\n        {activeRecurringDates.map( ( date, dateIndex ) => {\n            let _date = moment(moment(date).format(\"YYYY-MM-DD\")) // looped date.\n            let _selectedDateTime = null;\n            if (paxSelectorData.selectedDateTime) {\n                _selectedDateTime = moment(moment(paxSelectorData.selectedDateTime).format(\"YYYY-MM-DD\"));\n            }\n            let _pricingIds = getPricingsByDate(moment(date.start_date).toDate(), date.id);\n\n            let firstPricingId = _pricingIds[0];\n            let firstPricing = pricings[firstPricingId]\n\n            let firstCategories = firstPricing.categories\n            let firstCounts = {}\n            firstCategories.forEach(c => {\n                firstCounts = { ...firstCounts, [c.id]: parseInt(c.default_pax) || 0 }\n            })\n            let pricingOptions = []\n            if ( 'undefined' != typeof _pricingIds.length && _pricingIds.length ) {\n                pricingOptions = _pricingIds.map( (pricingId, pricingIndex) => {\n                    return { label: pricings[pricingId].title, value: pricingId }\n                })\n            }\n            return <>\n                { isTourDate(new Date( _date ) ) ? \n                 \n                    <tr key={dateIndex} className={_date.isSame( _selectedDateTime ) ? 'selected': ''} >\n                        <td data-label=\"pricings\">\n                            { 'undefined' != typeof _pricingIds.length && _pricingIds.length > 0 &&\n                                <>\n                                {/* <RadioControl\n                                    // label=\"User type\"\n                                    // help=\"The type of the current user\"\n                                    selected={paxSelectorData.selectedPricingId}\n                                    options={ pricingOptions}\n                                    onChange={ ( e ) => { \n                                        handleFixedDeparturePricingClick(_date, date.id, e )()\n                                    } } /> */}\n                                <>\n                                    {_pricingIds.map( (pricingId, pricingIndex) => {\n                                        return <CheckboxControl\n                                            key={pricingIndex}\n                                            label={pricings[pricingId].title}\n                                            checked={ paxSelectorData.selectedPricingId == pricingId && paxSelectorData.selectedPricingId == paxSelectorData.pricing.id && paxSelectorData.selectedDateIds.includes(data.id) && _date.isSame( _selectedDateTime ) }\n                                            onChange={ handleFixedDeparturePricingClick(_date, date.id, pricingId ) }\n                                        />\n                                        // return <li key={pricingIndex}>\n\n                                        //             {pricings[pricingId].title}\n                                                    \n                                        //             <button \n                                        //                 disabled={paxSelectorData.selectedPricingId == pricingId && paxSelectorData.selectedPricingId == paxSelectorData.pricing.id && paxSelectorData.selectedDateIds.includes(data.id) && _date.isSame( _selectedDateTime ) }\n                                        //                 className={paxSelectorData.selectedPricingId == pricingId ? 'active' : '' }\n                                        //                 onClick={handleFixedDeparturePricingClick(_date, date.id, pricingId )} >\n                                        //             </button>\n                                        //     </li>\n                                    })}\n                                </>\n                                </>\n                            }\n                        </td>\n                        <td data-label=\"person\">\n                            <div className =\"person-box\">\n                        {\n                        !paxSelectorData.pricingUnavailable && paxSelectorData.pricing && paxSelectorData.inventory.find(i => i.pax_available > 0 && paxSelectorData.selectedPricingId == paxSelectorData.pricing.id && paxSelectorData.selectedDateIds.includes(data.id) && _date.isSame( _selectedDateTime ) ) ? \n                            <>\n                            <PaxSelector\n                                pricing={paxSelectorData.pricing ? paxSelectorData.pricing : firstPricing }\n                                onPaxChange={paxSelectorData.onPaxChange}\n                                counts={paxSelectorData.counts ? paxSelectorData.counts : firstCounts }\n                                inventory={paxSelectorData.inventory}\n                            />\n                            {paxSelectorData.totalPax > 0 && _.size(paxSelectorData.pricing.trip_extras) > 0 && \n                                <ErrorBoundry>\n                                    <TripExtrasListing\n                                        options={paxSelectorData.pricing.trip_extras}\n                                        onChange={(id, value) => () => paxSelectorData.updateState({ tripExtras: { ...paxSelectorData.tripExtras, [id]: parseInt(value) } })}\n                                        counts={paxSelectorData.tripExtras}\n                                    />\n                                </ErrorBoundry>\n                            }\n                            </>\n                            : <Disabled>\n                                {/* Just to display */}\n                                <PaxSelector\n                                    pricing={ firstPricing }\n                                    onPaxChange={paxSelectorData.onPaxChange}\n                                    counts={firstCounts }\n                                    inventory={paxSelectorData.inventory}\n                                    />\n                            </Disabled>\n\n                        }\n                        </div>\n                        </td>\n                        <td data-label=\"date\">\n                            <div className=\"date-time-wrapper\">\n                                <span className=\"start-date\"><span>{__i18n.bookings.start_date}: </span>{_date.format(_wp_travel.date_format_moment)}</span>\n                            </div>\n                            {\n                                !paxSelectorData.pricingUnavailable && paxSelectorData.nomineeTimes.length > 0 && paxSelectorData.inventory.find(i => i.pax_available > 0 && paxSelectorData.selectedPricingId == paxSelectorData.pricing.id && paxSelectorData.selectedDateIds.includes(data.id) && _date.isSame( _selectedDateTime ) ) &&\n                                    <> \n                                    <TripTimesListing\n                                        selected={paxSelectorData.selectedDateTime}\n                                        onTimeSelect={paxSelectorData.onTimeSelect}\n                                        options={paxSelectorData.nomineeTimes}\n                                    />\n                                    </>\n                            }\n                            \n                       </td>\n                        {/* <td><button onClick={handleDateClick(_date)}>{_wp_travel.strings.bookings.book_now}</button></td> */}\n                    </tr>\n                    :\n                    <>\n                        <tr>\n                            <td>\n                                <Disabled>\n                                    { 'undefined' != typeof _pricingIds.length && _pricingIds.length > 0 &&\n                                        <>\n                                        <RadioControl\n                                            // label=\"User type\"\n                                            // help=\"The type of the current user\"\n                                            selected={paxSelectorData.selectedPricingId}\n                                            options={ pricingOptions}\n                                            onChange={ ( e ) => { \n                                                handleFixedDeparturePricingClick(date.start_date, date.id, e )()\n                                            } }\n                                        />\n                                        {/* <ul>\n                                            {_pricingIds.map( (pricingId, pricingIndex) => {\n                                                return <li key={pricingIndex}>\n                                                        <button onClick={handleFixedDeparturePricingClick(_date, date.id, pricingId )} >{pricings[pricingId].title}</button>\n                                                    </li>\n                                            })}\n                                        </ul> */}\n                                        </>\n                                    }\n                                </Disabled>\n                            </td>\n                            <td>\n                                <Disabled>\n                                    \n                                    <PaxSelector\n                                        pricing={ firstPricing }\n                                        onPaxChange={paxSelectorData.onPaxChange}\n                                        counts={firstCounts }\n                                        inventory={paxSelectorData.inventory}\n                                    />\n                                </Disabled>\n                            </td>\n                            <td data-label=\"date\"><Disabled>\n                                    <div className=\"date-time-wrapper\">\n                                    <span className=\"start-date\"><span>{__i18n.bookings.start_date}: </span>{_date.format(_wp_travel.date_format_moment)}</span>\n                                </div></Disabled>\n                            </td>\n                            {/* <td><Disabled><button onClick={handleDateClick(_date)}>{_wp_travel.strings.bookings.book_now}</button></Disabled></td> */}\n                        </tr>\n                    \n                    </>\n               \n                }\n            </>\n            \n        })}\n        </tbody> \n        <div className=\"wp-travel-recurring-dates-nav-btns\">\n            {activePage > 1 && <button onClick={loadMoreDates(-1)} className=\"prev\">{__('Previous')}</button>}\n            {activePage < pagesCount && activePage >= 1 && <button className=\"next\" onClick={loadMoreDates(1)}>{__('Next')}</button>}\n            { ( activePage >= pagesCount && activeRecurringDates.length >= datePerPage ) && <button onClick={loadMoreDates(1)} className=\"show-more\">{__('Load More...')}</button>}\n        </div>\n    </>\n}\n\nconst DatesListing = ({ dates, onDateClick, isTourDate, getPricingsByDate, allData, onFixedDeparturePricingSelect, paxSelectorData, getPricingTripTimes }) => {\n    const handleClick = ( date, date_id ) => () => {\n        if (typeof onDateClick === 'function') {\n            // console.log( 'Book now click step 1' );\n            onDateClick(moment(date).toDate(), date_id)\n\n            // Temp fixes[scroll to pricing if book now is clicked]\n            var top = jQuery('#wp-travel-booking-recurring-dates').offset().top\n            jQuery('html, body').animate({\n                scrollTop: ( top - 20 )\n            }, 1200);\n        }\n    }\n\n    const handlePricingClick = ( date, date_id, pricingId ) => () => {\n\n        if (typeof onFixedDeparturePricingSelect === 'function') {\n            onFixedDeparturePricingSelect(moment(date).toDate(), date_id, pricingId )\n        }\n    }\n\n    const _dates = Object.values(dates)\n    let nonRecurringDates = _dates.filter( d => { return !d.is_recurring && d.start_date && '0000-00-00' != d.start_date && new Date( d.start_date )  > new Date() } )\n    let pricings = allData.tripData && allData.tripData.pricings && _.keyBy(allData.tripData.pricings, p => p.id); // All Pricings.\n    let times = getPricingTripTimes(paxSelectorData.selectedPricingId, [])\n    return <>\n        {\n            _dates.length > 0 ? <>\n\n                <div className=\"wptravel-recurring-dates\">\n                    <div className=\"wptravel-recurring-table-wrapper\">\n                        {nonRecurringDates.length > 0 &&\n                        <>\n                            <table className=\"wptravel-recurring-table\">\n                                <thead className=\"thead-table\">\n                                    <tr>\n                                        <th data-label=\"pricings\">Pricings</th>\n                                        <th data-label=\"person\">Person</th>\n                                        <th data-label=\"date\">Date</th>\n                                        {/* <th>{_wp_travel.strings.bookings.action}</th> */}\n                                    </tr>\n                                </thead>\n                                <tbody className=\"tbody-table\">\n                                    {\n                                        nonRecurringDates.map((date, index) => {\n                                            let _pricingIds = getPricingsByDate(moment(date.start_date).toDate(), date.id);\n                                            let firstPricingId = _pricingIds[0];\n                                            let firstPricing = pricings[firstPricingId]\n\n                                            let firstCategories = firstPricing.categories\n                                            let firstCounts = {}\n                                            firstCategories.forEach(c => {\n                                                firstCounts = { ...firstCounts, [c.id]: parseInt(c.default_pax) || 0 }\n                                            })\n\n                                            let pricingOptions = []\n                                            if ( 'undefined' != typeof _pricingIds.length && _pricingIds.length ) {\n                                                pricingOptions = _pricingIds.map( (pricingId, pricingIndex) => {\n                                                    return { label: pricings[pricingId].title, value: pricingId }\n                                                })\n                                            }\n\n                                            let _selectedDateTime = null;\n                                            if ( 'undefined' != typeof paxSelectorData.selectedDateTime) {\n                                                _selectedDateTime = moment(moment(paxSelectorData.selectedDateTime).format(\"YYYY-MM-DD\"));\n                                            }\n                                            let _start_date = null;\n                                            if ( ! date.is_recurring && date.start_date ) {\n                                                _start_date = moment( moment(date.start_date).format(\"YYYY-MM-DD\") )\n                                            }\n                                            return <>\n                                                {! date.is_recurring && \n                                                    <>\n                                                    <tr key={index} className={_start_date.isSame( _selectedDateTime ) ? 'selected': ''}>\n                                                        <td data-label=\"pricings\">\n                                                            { 'undefined' != typeof _pricingIds.length && _pricingIds.length > 0 &&\n                                                            <>\n                                                                {/* <RadioControl\n                                                                    selected={paxSelectorData.selectedPricingId}\n                                                                    options={ pricingOptions}\n                                                                    onChange={ ( e ) => { \n                                                                        handlePricingClick(date.start_date, date.id, e )()\n                                                                    } }\n                                                                /> */}\n                                                                <>\n                                                                    {_pricingIds.map( (pricingId, pricingIndex) => {\n                                                                        return <CheckboxControl\n                                                                                key={pricingIndex}\n                                                                                label={pricings[pricingId].title}\n                                                                                checked={ paxSelectorData.selectedPricingId == pricingId && paxSelectorData.selectedDateIds.includes(date.id) }\n                                                                                onChange={ handlePricingClick(date.start_date, date.id, pricingId ) }\n                                                                            />\n                                                                        // return <li key={pricingIndex}>\n                                                                        //     <button\n                                                                        //         disabled={paxSelectorData.selectedPricingId == pricingId}\n                                                                        //         className={paxSelectorData.selectedPricingId == pricingId ? 'active' : '' }\n                                                                        //         onClick={ \n                                                                        //             handlePricingClick(date.start_date, date.id, pricingId )\n                                                                        //         } >\n                                                                        //         {pricings[pricingId].title}\n                                                                        //     </button>\n                                                                        // </li>\n                                                                    })}\n                                                                </>\n                                                            </>\n                                                            }\n                                                        </td>\n                                                        <td data-label=\"person\">\n                                                        <div className =\"person-box\">\n                                                        {\n                                                            !paxSelectorData.pricingUnavailable && paxSelectorData.pricing && paxSelectorData.inventory.find(i => i.pax_available > 0 && paxSelectorData.selectedPricingId == paxSelectorData.pricing.id && paxSelectorData.selectedDateIds.includes(date.id) ) ? \n                                                                <>\n                                                                    <PaxSelector\n                                                                        pricing={paxSelectorData.pricing ? paxSelectorData.pricing : firstPricing }\n                                                                        onPaxChange={paxSelectorData.onPaxChange}\n                                                                        counts={paxSelectorData.counts ? paxSelectorData.counts : firstCounts }\n                                                                        inventory={paxSelectorData.inventory}\n                                                                    />\n                                                                    {\n                                                                        paxSelectorData.totalPax > 0 && _.size(paxSelectorData.pricing.trip_extras) > 0 && <ErrorBoundry>\n                                                                            <TripExtrasListing\n                                                                                options={paxSelectorData.pricing.trip_extras}\n                                                                                onChange={(id, value) => () => paxSelectorData.updateState({ tripExtras: { ...paxSelectorData.tripExtras, [id]: parseInt(value) } })}\n                                                                                counts={paxSelectorData.tripExtras}\n                                                                            />\n                                                                        </ErrorBoundry>\n                                                                    }\n                                                                </>\n                                                                : <Disabled>\n                                                                    {/* Just to display */}\n                                                                    <PaxSelector\n                                                                        pricing={ firstPricing }\n                                                                        onPaxChange={paxSelectorData.onPaxChange}\n                                                                        counts={firstCounts }\n                                                                        inventory={paxSelectorData.inventory}\n                                                                        />\n                                                                </Disabled>\n\n                                                        }\n                                                        \n                                                        </div>\n                                                        </td>\n                                                        <td data-label=\"date\">\n                                                            <div className = \"date-box\">\n                                                                <div className=\"date-time-wrapper\">\n                                                                    <span className=\"start-date\"><span>{__i18n.bookings.start_date}: </span>{moment(date.start_date).format(_wp_travel.date_format_moment)}</span>\n                                                                    {date.end_date && '0000-00-00' != date.end_date && <span className=\"end-date\"><span>{__i18n.bookings.end_date}: </span>{moment(date.end_date).format(_wp_travel.date_format_moment)}</span> }\n                                                                </div>\n                                                                    { !paxSelectorData.pricingUnavailable && paxSelectorData.nomineeTimes.length > 0 && paxSelectorData.selectedPricingId == paxSelectorData.pricing.id && paxSelectorData.selectedDateIds.includes(date.id) &&\n                                                                        <> \n                                                                        <TripTimesListing\n                                                                            selected={paxSelectorData.selectedDateTime}\n                                                                            onTimeSelect={paxSelectorData.onTimeSelect}\n                                                                            options={paxSelectorData.nomineeTimes}\n                                                                        />\n                                                                        </>\n                                                                    }\n                                                            </div>\n                                                        </td>\n                                                        {/* <td>\n                                                            <button className=\"wp-travel-recurring-date-picker-btn\" key={index} onClick={handleClick(date.start_date, date.id)}>\n                                                            {_wp_travel.strings.bookings.book_now}\n                                                            </button>\n                                                        </td> */}\n                                                    </tr>\n                                                    </>\n                                                }\n                                            </>\n                                        })\n                                    }\n                                </tbody>\n                            </table>\n                        </>\n                        }\n                    </div>\n                    {/* Recurring */}\n                    {_dates.map((date, index) => {\n                        return <>\n                            { date.is_recurring && \n                                <PanelBody title={__( `${_wp_travel.strings.bookings.recurring} ${date.title}`, 'wp-travel' )} initialOpen={true} key={index} >\n                                    <PanelRow>\n                                    <table>\n                                        <thead className=\"thead-table\">\n                                            <tr>\n                                                <th data-label=\"pricings\">Pricings</th>\n                                                <th data-label=\"person\">Person</th>\n                                                <th data-label=\"date\">Date</th>\n                                                {/* <th>{_wp_travel.strings.bookings.action}</th> */}\n                                            </tr>\n                                        </thead>\n                                        <RecurringDates data={date} onDateClick={handleClick} onFixedDeparturePricingSelect={handlePricingClick} getPricingsByDate={getPricingsByDate} isTourDate={isTourDate} allData={allData} paxSelectorData={paxSelectorData} key={index} />\n                                        \n                                    </table>\n                                    </PanelRow>\n                                </PanelBody>\n                            }\n                            </>\n                        })\n                    }\n                    <div id=\"wp-travel-booking-recurring-dates\"></div> {/* <!-- required for scroll pricing --> */}\n                </div>\n            </> : <> Please add date.</>\n        }\n    </>\n}\n\nexport default DatesListing","import { __ } from '@wordpress/i18n'\nimport { Fragment } from '@wordpress/element'\nimport { wpTravelFormat } from '../functions'\n\nconst _ = lodash\nconst { currency_symbol: currencySymbol } = _wp_travel\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconst DiscountTable = ({ groupPricings }) => {\n\treturn <div className=\"discount-table\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th colSpan=\"2\">{wp_travel.strings.bookings.pax}</th>\n\t\t\t\t\t<th rowSpan=\"2\">{wp_travel.strings.bookings.price}</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>{wp_travel.strings.from}</th>\n\t\t\t\t\t<th>{wp_travel.strings.to}</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t{\n\t\t\t\t\tgroupPricings.map((gp, index) => {\n\t\t\t\t\t\treturn <tr key={index}>\n\t\t\t\t\t\t\t<td>{gp.min_pax}</td>\n\t\t\t\t\t\t\t<td>{gp.max_pax}</td>\n\t\t\t\t\t\t\t<td dangerouslySetInnerHTML={{ __html: wpTravelFormat(gp.price) }}></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n}\n\nconst PaxSelector = ({ pricing, onPaxChange, counts, inventory }) => {\n\t// console.log('counts', counts);\n\tlet categories = pricing && pricing.categories || []\n\tconst getCategoryPrice = (categoryId, single) => { // This function handles group discounts as well\n\t\tlet category = pricing.categories.find(c => c.id == categoryId)\n\t\tif (!category) {\n\t\t\treturn\n\t\t}\n\t\tlet count = counts[categoryId] || 0\n\t\tlet price = category && category.is_sale ? category.sale_price : category.regular_price\n\n\t\tif (category.has_group_price && category.group_prices.length > 0) { // If has group price/discount.\n\t\t\t// hasGroupPrice = true\n\t\t\tlet groupPrices = _.orderBy(category.group_prices, gp => parseInt(gp.max_pax))\n\t\t\tlet group_price = groupPrices.find(gp => parseInt(gp.min_pax) <= count && parseInt(gp.max_pax) >= count)\n\t\t\tif (group_price && group_price.price) {\n\t\t\t\tif (single)\n\t\t\t\t\treturn parseFloat(group_price.price)\n\t\t\t\tprice = 'group' === category.price_per ? (count > 0 ? parseFloat(group_price.price) : 0) : parseFloat(group_price.price) * count\n\t\t\t} else {\n\t\t\t\tif (single)\n\t\t\t\t\treturn parseFloat(price)\n\t\t\t\tprice = 'group' === category.price_per ? (count > 0 ? parseFloat(price) : 0) : parseFloat(price) * count\n\t\t\t}\n\t\t} else {\n\t\t\tif (single)\n\t\t\t\treturn parseFloat(price)\n\t\t\tprice = 'group' === category.price_per ? (count > 0 ? parseFloat(price) : 0) : parseFloat(price) * count\n\t\t}\n\t\treturn price || 0\n\t}\n\n\t// const groupDiscountClickhandler = e => {\n\t// \tlet dt = e.target.closest('li').querySelector('.discount-table')\n\t// \tif (dt && dt.style.display == 'none') {\n\t// \t\tdt.removeAttribute('style')\n\t// \t} else {\n\t// \t\tdt.style.display = 'none'\n\t// \t}\n\t// }\n\n\treturn <div className=\"wp-travel-booking__pax-selector-wrapper\">\n\t\t<h4>{__i18n.bookings.booking_tab_pax_selector}</h4>\n\t\t<ul className=\"wp-travel-booking__trip-option-list\">\n\t\t\t{\n\t\t\t\tcategories.map((c, i) => {\n\t\t\t\t\tlet price = c.is_sale ? c.sale_price : c.regular_price\n\t\t\t\t\tif ( 'undefined' == typeof c.term_info ) { // Fixes : index title of undefined.\n\t\t\t\t\t\treturn <></>\n\t\t\t\t\t}\n\t\t\t\t\treturn <li key={i}>\n\t\t\t\t\t\t<div className=\"text-left\">\n\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t{`${c.term_info.title}`} &nbsp;\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t// Currently not supported for time. Need enhancement later.\n\t\t\t\t\t\t\t\t\tinventory && inventory.length < 2 && 'undefined' != typeof inventory[0] && inventory[0].booked_pax > 0 ?\n\t\t\t\t\t\t\t\t\t<span className=\"wp_travel_pax_info\">({`${counts[c.id]}`}/{`${inventory[0].pax_available}`})</span> :\n\t\t\t\t\t\t\t\t\t<span className=\"wp_travel_pax_info\">({`${counts[c.id]}`}/{`${pricing.max_pax}`})</span>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t{c.has_group_price && c.group_prices.length > 0 && <span className=\"tooltip group-discount-button\">\n\t\t\t\t\t\t\t\t<span>{__i18n.bookings.group_discount_tooltip}</span>\n\t\t\t\t\t\t\t\t<svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512.003 512.003\" style={{ enableBackground: 'new 0 0 512.003 512.003' }}><path d=\"M477.958,262.633c-2.06-4.215-2.06-9.049,0-13.263l19.096-39.065c10.632-21.751,2.208-47.676-19.178-59.023l-38.41-20.38\n                                        c-4.144-2.198-6.985-6.11-7.796-10.729l-7.512-42.829c-4.183-23.846-26.241-39.87-50.208-36.479l-43.053,6.09\n                                        c-4.647,0.656-9.242-0.838-12.613-4.099l-31.251-30.232c-17.401-16.834-44.661-16.835-62.061,0L193.72,42.859\n                                        c-3.372,3.262-7.967,4.753-12.613,4.099l-43.053-6.09c-23.975-3.393-46.025,12.633-50.208,36.479l-7.512,42.827\n                                        c-0.811,4.62-3.652,8.531-7.795,10.73l-38.41,20.38c-21.386,11.346-29.81,37.273-19.178,59.024l19.095,39.064\n                                        c2.06,4.215,2.06,9.049,0,13.263l-19.096,39.064c-10.632,21.751-2.208,47.676,19.178,59.023l38.41,20.38\n                                        c4.144,2.198,6.985,6.11,7.796,10.729l7.512,42.829c3.808,21.708,22.422,36.932,43.815,36.93c2.107,0,4.245-0.148,6.394-0.452\n                                        l43.053-6.09c4.643-0.659,9.241,0.838,12.613,4.099l31.251,30.232c8.702,8.418,19.864,12.626,31.03,12.625\n                                        c11.163-0.001,22.332-4.209,31.03-12.625l31.252-30.232c3.372-3.261,7.968-4.751,12.613-4.099l43.053,6.09\n                                        c23.978,3.392,46.025-12.633,50.208-36.479l7.513-42.827c0.811-4.62,3.652-8.531,7.795-10.73l38.41-20.38\n                                        c21.386-11.346,29.81-37.273,19.178-59.024L477.958,262.633z M196.941,123.116c29.852,0,54.139,24.287,54.139,54.139\n                                        s-24.287,54.139-54.139,54.139s-54.139-24.287-54.139-54.139S167.089,123.116,196.941,123.116z M168.997,363.886\n                                        c-2.883,2.883-6.662,4.325-10.44,4.325s-7.558-1.441-10.44-4.325c-5.766-5.766-5.766-15.115,0-20.881l194.889-194.889\n                                        c5.765-5.766,15.115-5.766,20.881,0c5.766,5.766,5.766,15.115,0,20.881L168.997,363.886z M315.061,388.888\n                                        c-29.852,0-54.139-24.287-54.139-54.139s24.287-54.139,54.139-54.139c29.852,0,54.139,24.287,54.139,54.139\n                                        S344.913,388.888,315.061,388.888z\"></path><path d=\"M315.061,310.141c-13.569,0-24.609,11.039-24.609,24.608s11.039,24.608,24.609,24.608\n                                        c13.569,0,24.608-11.039,24.608-24.608S328.63,310.141,315.061,310.141z\"></path><path d=\"M196.941,152.646c-13.569,0-24.608,11.039-24.608,24.608c0,13.569,11.039,24.609,24.608,24.609\n                                        c13.569,0,24.609-11.039,24.609-24.609C221.549,163.686,210.51,152.646,196.941,152.646z\"></path>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t{__i18n.bookings.view_group_discount}\n\t\t\t\t\t\t\t\t{c.has_group_price && c.group_prices.length > 0 && <DiscountTable groupPricings={c.group_prices} />}\n\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t<span className=\"item-price\">{c.is_sale && <del dangerouslySetInnerHTML={{ __html: wpTravelFormat(c.regular_price) }}></del>} <span dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCategoryPrice(c.id, true)) }}></span>/{c.price_per}</span>\n\t\t\t\t\t\t\t<div className=\"pricing-area\">\n\t\t\t\t\t\t\t\t<div className=\"qty-spinner\">\n\t\t\t\t\t\t\t\t\t<button onClick={onPaxChange(c.id, -1)}>-</button>\n\t\t\t\t\t\t\t\t\t<span>{typeof counts[c.id] == 'undefined' ? parseInt(c.default_pax) : counts[c.id]}</span>\n\t\t\t\t\t\t\t\t\t<button onClick={onPaxChange(c.id, 1)}>+</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/* <div className=\"price\" dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCategoryPrice(c.id)) }}></div> */}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t})\n\t\t\t}\n\t\t</ul>\n\t</div>\n}\n\nexport default PaxSelector","import { useSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\n\nconst _ = lodash\nconst storeName = 'WPTravelFrontend/BookingWidget';\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconst PricingListing =  ({ selected, options, onPricingSelect }) => {\n\n\tconst allData = useSelect((select) => {\n\t\treturn select(storeName).getAllStore()\n\t}, []);\n\n\tlet pricings = allData.tripData && allData.tripData.pricings && _.keyBy(allData.tripData.pricings, p => p.id)\n\treturn <div className=\"wp-travel-booking__pricing-name\">\n\t\t{\n\t\t\toptions.length > 1 && <>\n\t\t\t\t<h4>{__i18n.bookings.pricings_list_label}</h4>\n\t\t\t\t{\n\t\t\t\t\toptions.map(\n\t\t\t\t\t\t(id, i) => <button key={i}\n\t\t\t\t\t\t\tdisabled={selected == id}\n\t\t\t\t\t\t\tclassName={selected == id ? 'active' : ''}\n\t\t\t\t\t\t\tonClick={onPricingSelect(id)}>\n\t\t\t\t\t\t\t{pricings[id] && pricings[id].title}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</>\n\t\t}\n\t</div>\n}\n\nexport default PricingListing","import { __ } from '@wordpress/i18n';\nimport { wpTravelFormat } from '../functions'\n\nconst { currency_symbol: currencySymbol } = _wp_travel\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconst TripExtrasListing = ({ options, onChange, counts }) => {\n\tconst handleClick = (index, inc) => () => {\n\t\tlet id = options[index].id\n\t\tlet _xcount = counts[id] + inc < 0 ? 0 : counts[id] + inc\n\t\tif (options[index].is_required && _xcount <= 0)\n\t\t\t_xcount = 1\n\t\tonChange(id, _xcount)()\n\t}\n\n\treturn <div className=\"wp-travel-booking__trip-extras-wrapper\">\n\t\t{\n\t\t\toptions.length > 0 && <>\n\t\t\t\t<h4>{__i18n.bookings.trip_extras_list_label}</h4>\n\t\t\t\t<ul className=\"wp-travel-booking__trip-option-list\">\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.map((tx, i) => {\n\t\t\t\t\t\t\tif (typeof tx.tour_extras_metas == 'undefined') {\n\t\t\t\t\t\t\t\treturn <li key={i}>\n\t\t\t\t\t\t\t\t\t<span className={`checkbox checked`}>\n\t\t\t\t\t\t\t\t\t\t<svg className=\"tick\" version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{ enableBackground: 'new 0 0 512 512' }}>\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0\n                                c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7\n                                C514.5,101.703,514.499,85.494,504.502,75.496z\"></path>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<div className=\"text-left\">\n\t\t\t\t\t\t\t\t\t\t<strong>{tx.title}\n\t\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t\t\t{tx.content && <div>\n\t\t\t\t\t\t\t\t\t\t\t<p dangerouslySetInnerHTML={{ __html: tx.content }}></p>\n\t\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet price = tx.is_sale && tx.tour_extras_metas.extras_item_sale_price || tx.tour_extras_metas.extras_item_price\n\t\t\t\t\t\t\tprice = parseFloat(price)\n\t\t\t\t\t\t\tlet _count = counts[tx.id]\n\t\t\t\t\t\t\treturn <li key={i} className={tx.is_required ? 'wp-travel__required-extra' : ''}>\n\t\t\t\t\t\t\t\t<span className={`checkbox${_count > 0 ? ' checked' : ''}`}>\n\t\t\t\t\t\t\t\t\t<svg className=\"tick\" version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{ enableBackground: 'new 0 0 512 512' }}>\n\t\t\t\t\t\t\t\t\t\t<path d=\"M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0\n                                c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7\n                                C514.5,101.703,514.499,85.494,504.502,75.496z\"></path>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<div className=\"text-left\">\n\t\t\t\t\t\t\t\t\t<div className=\"title\">\n\t\t\t\t\t\t\t\t\t\t<strong>{tx.title}\n\t\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"info-container\">\n\t\t\t\t\t\t\t\t\t\t<a className=\"info\">\n\t\t\t\t\t\t\t\t\t\t\t{tx.content && \n\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"info-icon\">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"info-circle\" class=\"svg-inline--fa fa-info-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z\"></path></svg>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"infoBox\">\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"desc\" dangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t__html: `${tx.content}${tx.link && `<a target=\"new\" href=\"${tx.link}\">${__i18n.bookings.trip_extras_link_label}</a>`}`\n\t\t\t\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t\t<span className=\"item-price\">{tx.is_sale && <del dangerouslySetInnerHTML={{__html: wpTravelFormat(tx.tour_extras_metas.extras_item_price)}}></del>} <span dangerouslySetInnerHTML={{__html: wpTravelFormat(price)}}></span> /unit</span>\n\t\t\t\t\t\t\t\t\t<div className=\"pricing-area\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"qty-spinner\">\n\t\t\t\t\t\t\t\t\t\t\t<button onClick={handleClick(i, -1)}>-</button>\n\t\t\t\t\t\t\t\t\t\t\t<span>{_count}</span>\n\t\t\t\t\t\t\t\t\t\t\t<button onClick={handleClick(i, 1)}>+</button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/* <div className=\"price\" dangerouslySetInnerHTML={{__html: wpTravelFormat(_count * price)}}></div> */}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</ul>\n\t\t\t</>\n\t\t}\n\t</div >\n}\n\nexport default TripExtrasListing","import { __ } from '@wordpress/i18n';\n\nconst __i18n = {\n\t..._wp_travel.strings\n}\n\nconst TripTimesListing =  ({ selected, options, onTimeSelect }) => {\n\n\treturn <div className=\"wp-travel-booking__selected-time\">\n\t\t{options.length > 0 && <>\n\t\t\t<h4>{`${__i18n.bookings.available_trip_times}`}</h4>\n\t\t\t{\n\t\t\t\toptions.map((timeObject, i) => {\n\t\t\t\t\t// let timeObject = moment(`${selectedDate.toDateString()} ${time}`) // TODO: save times to state as date object.\n\t\t\t\t\treturn <button key={i} disabled={timeObject.isSame(selected)} onClick={onTimeSelect(timeObject)}>\n\t\t\t\t\t\t{timeObject.format('h:mm A')}\n\t\t\t\t\t</button>\n\t\t\t\t})\n\t\t\t}\n\t\t</>}\n\t</div>\n}\n\nexport default TripTimesListing","import { __ } from '@wordpress/i18n'\nimport { Fragment, useEffect } from '@wordpress/element'\nimport { wpTravelFormat, wpTravelFormatV2 } from '../../functions'\n\nconst _ = lodash\nconst { currency_symbol: currencySymbol } = _wp_travel\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconst DiscountTable = ({ groupPricings }) => {\n\treturn <div className=\"discount-table\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th colSpan=\"2\">{wp_travel.strings.bookings.pax}</th>\n\t\t\t\t\t<th rowSpan=\"2\">{wp_travel.strings.bookings.price}</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>{wp_travel.strings.from}</th>\n\t\t\t\t\t<th>{wp_travel.strings.to}</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t{\n\t\t\t\t\tgroupPricings.map((gp, index) => {\n\t\t\t\t\t\treturn <tr key={index}>\n\t\t\t\t\t\t\t<td>{gp.min_pax}</td>\n\t\t\t\t\t\t\t<td>{gp.max_pax}</td>\n\t\t\t\t\t\t\t<td dangerouslySetInnerHTML={{ __html: wpTravelFormatV2(gp.price) }}></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n}\n\nconst PaxSelectorV2 = ({ pricing, onPaxChange, counts, toggler }) => {\n\tlet categories = pricing && pricing.categories || []\n\tconst getCategoryPrice = (categoryId, single) => { // This function handles group discounts as well\n\t\tlet category = pricing.categories.find(c => c.id == categoryId)\n\t\tif (!category) {\n\t\t\treturn\n\t\t}\n\t\tlet count = counts[categoryId] || 0\n\t\tlet price = category && category.is_sale ? category.sale_price : category.regular_price\n\n\t\tif (category.has_group_price && category.group_prices.length > 0) { // If has group price/discount.\n\t\t\t// hasGroupPrice = true\n\t\t\tlet groupPrices = _.orderBy(category.group_prices, gp => parseInt(gp.max_pax))\n\t\t\tlet group_price = groupPrices.find(gp => parseInt(gp.min_pax) <= count && parseInt(gp.max_pax) >= count)\n\t\t\tif (group_price && group_price.price) {\n\t\t\t\tif (single)\n\t\t\t\t\treturn parseFloat(group_price.price)\n\t\t\t\tprice = 'group' === category.price_per ? (count > 0 ? parseFloat(group_price.price) : 0) : parseFloat(group_price.price) * count\n\t\t\t} else {\n\t\t\t\tif (single)\n\t\t\t\t\treturn parseFloat(price)\n\t\t\t\tprice = 'group' === category.price_per ? (count > 0 ? parseFloat(price) : 0) : parseFloat(price) * count\n\t\t\t}\n\t\t} else {\n\t\t\tif (single)\n\t\t\t\treturn parseFloat(price)\n\t\t\tprice = 'group' === category.price_per ? (count > 0 ? parseFloat(price) : 0) : parseFloat(price) * count\n\t\t}\n\t\treturn price || 0\n\t}\n\n\tconst groupDiscountClickhandler = e => {\n\t\tlet dt = e.target.closest('div').querySelector('.discount-table')\n\t\tconsole.log(dt)\n\t\tif (dt && dt.style.display == 'none') {\n\t\t\tdt.removeAttribute('style')\n\t\t} else {\n\t\t\tdt.style.display = 'none'\n\t\t}\n\t}\n\n\tfunction bookingSelectorPaxToggle(){\n\t\tjQuery('.wti__selector-heading.pax').parents('.wti__selector-item').toggleClass('active');\n\t\tjQuery('.wti__selector-heading.pax').siblings('.wti__selector-content-wrapper').stop().slideToggle();\n\t}\n\n\treturn <div className=\"wti__selector-item wti__pax-selector active\">\n\t\t<h5 className=\"wti__selector-heading pax\" onClick={bookingSelectorPaxToggle}>\n\t\t\t{__i18n.bookings.booking_tab_pax_selector}\n\t\t\t<div className=\"buttons\">\n\t\t\t\t<span className=\"toggler-icon\"><i className=\"fas fa-chevron-down\"></i></span>\n\t\t\t</div>\n\t\t</h5>\n\t\t<div className=\"wti__selector-content-wrapper\">\n\t\t\t<div className=\"wti__selector-inner\">\n\t\t\t{\n\t\t\t\tcategories.map((c, i) => {\n\t\t\t\t\tlet price = c.is_sale ? c.sale_price : c.regular_price\n\t\t\t\t\treturn <div className=\"wti__selector-option\" key={i}>\n\t\t\t\t\t\t\t<div className=\"wti__pax_info\">\n\t\t\t\t\t\t\t\t<h6 className=\"wti__selector-option-title\">{`${c.term_info.title}`}</h6>\n\t\t\t\t\t\t\t\t{c.has_group_price && c.group_prices.length > 0 && <span className=\"tooltip wti-group-discount-button\">\n\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tc.has_group_price && c.group_prices.length > 0 && <DiscountTable groupPricings={c.group_prices} />\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512.003 512.003\" style={{ enableBackground: 'new 0 0 512.003 512.003' }}><path d=\"M477.958,262.633c-2.06-4.215-2.06-9.049,0-13.263l19.096-39.065c10.632-21.751,2.208-47.676-19.178-59.023l-38.41-20.38\n\t\t\t\t\t\t\t\t\t\t\tc-4.144-2.198-6.985-6.11-7.796-10.729l-7.512-42.829c-4.183-23.846-26.241-39.87-50.208-36.479l-43.053,6.09\n\t\t\t\t\t\t\t\t\t\t\tc-4.647,0.656-9.242-0.838-12.613-4.099l-31.251-30.232c-17.401-16.834-44.661-16.835-62.061,0L193.72,42.859\n\t\t\t\t\t\t\t\t\t\t\tc-3.372,3.262-7.967,4.753-12.613,4.099l-43.053-6.09c-23.975-3.393-46.025,12.633-50.208,36.479l-7.512,42.827\n\t\t\t\t\t\t\t\t\t\t\tc-0.811,4.62-3.652,8.531-7.795,10.73l-38.41,20.38c-21.386,11.346-29.81,37.273-19.178,59.024l19.095,39.064\n\t\t\t\t\t\t\t\t\t\t\tc2.06,4.215,2.06,9.049,0,13.263l-19.096,39.064c-10.632,21.751-2.208,47.676,19.178,59.023l38.41,20.38\n\t\t\t\t\t\t\t\t\t\t\tc4.144,2.198,6.985,6.11,7.796,10.729l7.512,42.829c3.808,21.708,22.422,36.932,43.815,36.93c2.107,0,4.245-0.148,6.394-0.452\n\t\t\t\t\t\t\t\t\t\t\tl43.053-6.09c4.643-0.659,9.241,0.838,12.613,4.099l31.251,30.232c8.702,8.418,19.864,12.626,31.03,12.625\n\t\t\t\t\t\t\t\t\t\t\tc11.163-0.001,22.332-4.209,31.03-12.625l31.252-30.232c3.372-3.261,7.968-4.751,12.613-4.099l43.053,6.09\n\t\t\t\t\t\t\t\t\t\t\tc23.978,3.392,46.025-12.633,50.208-36.479l7.513-42.827c0.811-4.62,3.652-8.531,7.795-10.73l38.41-20.38\n\t\t\t\t\t\t\t\t\t\t\tc21.386-11.346,29.81-37.273,19.178-59.024L477.958,262.633z M196.941,123.116c29.852,0,54.139,24.287,54.139,54.139\n\t\t\t\t\t\t\t\t\t\t\ts-24.287,54.139-54.139,54.139s-54.139-24.287-54.139-54.139S167.089,123.116,196.941,123.116z M168.997,363.886\n\t\t\t\t\t\t\t\t\t\t\tc-2.883,2.883-6.662,4.325-10.44,4.325s-7.558-1.441-10.44-4.325c-5.766-5.766-5.766-15.115,0-20.881l194.889-194.889\n\t\t\t\t\t\t\t\t\t\t\tc5.765-5.766,15.115-5.766,20.881,0c5.766,5.766,5.766,15.115,0,20.881L168.997,363.886z M315.061,388.888\n\t\t\t\t\t\t\t\t\t\t\tc-29.852,0-54.139-24.287-54.139-54.139s24.287-54.139,54.139-54.139c29.852,0,54.139,24.287,54.139,54.139\n\t\t\t\t\t\t\t\t\t\t\tS344.913,388.888,315.061,388.888z\"></path><path d=\"M315.061,310.141c-13.569,0-24.609,11.039-24.609,24.608s11.039,24.608,24.609,24.608\n\t\t\t\t\t\t\t\t\t\t\tc13.569,0,24.608-11.039,24.608-24.608S328.63,310.141,315.061,310.141z\"></path><path d=\"M196.941,152.646c-13.569,0-24.608,11.039-24.608,24.608c0,13.569,11.039,24.609,24.608,24.609\n\t\t\t\t\t\t\t\t\t\t\tc13.569,0,24.609-11.039,24.609-24.609C221.549,163.686,210.51,152.646,196.941,152.646z\"></path>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t{__i18n.bookings.view_group_discount}\n\t\t\t\t\t\t\t\t</span>}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"wti_item-price\">{c.is_sale && <del dangerouslySetInnerHTML={{ __html: wpTravelFormat(c.regular_price) }}></del>} <span dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCategoryPrice(c.id, true)) }}></span>/{c.price_per}</span>\n\t\t\t\t\t\t<div className=\"wti__selector-people-input\">\n\t\t\t\t\t\t\t{/* <span className=\"item-price\">{c.is_sale && <del dangerouslySetInnerHTML={{ __html: wpTravelFormat(c.regular_price) }}></del>} <span dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCategoryPrice(c.id, true)) }}></span>/{c.price_per}</span> */}\n\t\t\t\t\t\t\t<div className=\"input-field\">\n\t\t\t\t\t\t\t\t<button className=\"decrease_val\" onClick={onPaxChange(c.id, -1)}>-</button>\n\t\t\t\t\t\t\t\t<input type=\"number\" value={typeof counts[c.id] == 'undefined' ? parseInt(c.default_pax) : counts[c.id]} readOnly/>\n\t\t\t\t\t\t\t\t{/* <span>{typeof counts[c.id] == 'undefined' ? parseInt(c.default_pax) : counts[c.id]}</span> */}\n\t\t\t\t\t\t\t\t<button className=\"increase_val\" onClick={onPaxChange(c.id, 1)}>+</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"wti__input-display-figure\"><h6 dangerouslySetInnerHTML={{ __html: wpTravelFormat(getCategoryPrice(c.id)) }}></h6></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t})\n\t\t\t}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n}\n\nexport default PaxSelectorV2","import { useSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\n\nconst _ = lodash\nconst storeName = 'WPTravelFrontend/BookingWidget';\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconst PricingListingV2 =  ({ selected, options, onPricingSelect }) => {\n\n\tconst allData = useSelect((select) => {\n\t\treturn select(storeName).getAllStore()\n\t}, []);\n\n\tlet pricings = allData.tripData && allData.tripData.pricings && _.keyBy(allData.tripData.pricings, p => p.id)\n\treturn <div className=\"wti-booking__pricing-name\">\n\t\t{\n\t\t\toptions.length > 1 && <>\n\t\t\t\t<h4>{__i18n.bookings.pricings_list_label}</h4>\n\t\t\t\t<div className=\"wti_price_lists\">\n\t\t\t\t{\n\t\t\t\t\toptions.map(\n\t\t\t\t\t\t(id, i) => <button key={i}\n\t\t\t\t\t\t\tdisabled={selected == id}\n\t\t\t\t\t\t\tclassName={selected == id ? 'active' : ''}\n\t\t\t\t\t\t\tonClick={onPricingSelect(id)}>\n\t\t\t\t\t\t\t{pricings[id] && pricings[id].title}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t}\n\t</div>\n}\n\nexport default PricingListingV2","import { __ } from '@wordpress/i18n';\nimport { wpTravelFormat } from '../../functions'\n\nconst { currency_symbol: currencySymbol } = _wp_travel\nconst __i18n = {\n\t..._wp_travel.strings\n}\nconst TripExtrasListingV2 = ({ options, onChange, counts, toggler }) => {\n\tconsole.log(options);\n\tconst handleClick = (index, inc) => () => {\n\t\tlet id = options[index].id\n\t\tlet _xcount = counts[id] + inc < 0 ? 0 : counts[id] + inc\n\t\tif (options[index].is_required && _xcount <= 0)\n\t\t\t_xcount = 1\n\t\tonChange(id, _xcount)()\n\t}\n\tfunction bookingSelectorExtrasToggle(){\n\t\tjQuery('.wti__selector-heading.extras').parents('.wti__selector-item.wti__trip-extras ').toggleClass('active');\n\t\tjQuery('.wti__selector-heading.extras').siblings('.wti__selector-content-wrapper').stop().slideToggle();\n\t}\n\n\treturn <div className=\"wti__selector-item wti__trip-extras active\">\n\t\t{\n\t\t\toptions.length > 0 && <>\n\t\t\t\t<h5 className=\"wti__selector-heading extras\" onClick={bookingSelectorExtrasToggle}>\n\t\t\t\t\t{__i18n.bookings.trip_extras_list_label}\n\t\t\t\t\t<div className=\"buttons\">\n\t\t\t\t\t\t<span className=\"toggler-icon\"><i className=\"fas fa-chevron-down\"></i></span>\n\t\t\t\t\t</div>\n\t\t\t\t</h5>\n\t\t\t\t<div className=\"wti__selector-content-wrapper\">\n\t\t\t\t\t<div className=\"wti__selector-inner\">\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.map((tx, i) => {\n\t\t\t\t\t\t\tif (typeof tx.tour_extras_metas == 'undefined') {\n\t\t\t\t\t\t\t\treturn <div className=\"wti__selector-option\" key={i}>\n\t\t\t\t\t\t\t\t\t<span className={`checkbox checked`}>\n\t\t\t\t\t\t\t\t\t\t<svg className=\"tick\" version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{ enableBackground: 'new 0 0 512 512' }}>\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0\n                                c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7\n                                C514.5,101.703,514.499,85.494,504.502,75.496z\"></path>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<div className=\"wti__trip_extras_info\">\n\t\t\t\t\t\t\t\t\t\t<h6 className=\"wti__selector-option-title\">\n\t\t\t\t\t\t\t\t\t\t\t{tx.title}\n\t\t\t\t\t\t\t\t\t\t</h6>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{tx.content && <div className=\"wti__trip_extra_content\">\n\t\t\t\t\t\t\t\t\t\t<p dangerouslySetInnerHTML={{ __html: tx.content }}></p>\n\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet price = tx.is_sale && tx.tour_extras_metas.extras_item_sale_price || tx.tour_extras_metas.extras_item_price\n\t\t\t\t\t\t\tprice = parseFloat(price)\n\t\t\t\t\t\t\tlet _count = counts[tx.id]\n\t\t\t\t\t\t\treturn <div key={i} className={tx.is_required ? 'wti__selector-option wti__required-extra' : 'wti__selector-option'}>\n\t\t\t\t\t\t\t\t<span className={`checkbox${_count > 0 ? ' checked' : ''}`}>\n\t\t\t\t\t\t\t\t\t<svg className=\"tick\" version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{ enableBackground: 'new 0 0 512 512' }}>\n\t\t\t\t\t\t\t\t\t\t<path d=\"M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0\n                                c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7\n                                C514.5,101.703,514.499,85.494,504.502,75.496z\"></path>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<div className=\"wti__trip_extras_info\">\n\t\t\t\t\t\t\t\t\t<h6 className=\"wti__selector-option-title\">{tx.title}</h6>\n\t\t\t\t\t\t\t\t\t<span className=\"wti_item-price\">{tx.is_sale && <del dangerouslySetInnerHTML={{__html: wpTravelFormat(tx.tour_extras_metas.extras_item_price)}}></del>} <span dangerouslySetInnerHTML={{__html: wpTravelFormat(price)}}></span> /unit</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{tx.excerpt && <div className=\"wti__trip_extra_content\">\n\t\t\t\t\t\t\t\t\t<p dangerouslySetInnerHTML={{__html: `${tx.excerpt}${tx.link && `<a class=\"wti_excerpt\" target=\"new\" href=\"${tx.link}\">${__i18n.bookings.trip_extras_link_label}</a>`}`}}>\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t<div className=\"wti__selector-people-input\">\n\t\t\t\t\t\t\t\t\t<div className=\"input-field\">\n\t\t\t\t\t\t\t\t\t\t<button className=\"decrease_val\" onClick={handleClick(i, -1)}>-</button>\n\t\t\t\t\t\t\t\t\t\t<input type=\"number\" value={_count} readOnly/>\n\t\t\t\t\t\t\t\t\t\t<button className=\"increase_val\" onClick={handleClick(i, 1)}>+</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"wti__input-display-figure\"> \n\t\t\t\t\t\t\t\t\t\t<h6 dangerouslySetInnerHTML={{__html: wpTravelFormat(_count * price)}}></h6>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</>\n\t\t}\n\t</div >\n}\n\nexport default TripExtrasListingV2","import { __ } from '@wordpress/i18n';\n\nconst __i18n = {\n\t..._wp_travel.strings\n}\n\nconst TripTimesListingV2 =  ({ selected, options, onTimeSelect }) => {\n\n\treturn <div className=\"wti-booking__selected-time\">\n\t\t{options.length > 0 && <>\n\t\t\t<h4>{`${__i18n.bookings.available_trip_times}`}</h4>\n\t\t\t<div className=\"wti_trip_times\">\n\t\t\t{\n\t\t\t\toptions.map((timeObject, i) => {\n\t\t\t\t\t// let timeObject = moment(`${selectedDate.toDateString()} ${time}`) // TODO: save times to state as date object.\n\t\t\t\t\treturn <button key={i} disabled={timeObject.isSame(selected)} onClick={onTimeSelect(timeObject)}>\n\t\t\t\t\t\t{timeObject.format('h:mm A')}\n\t\t\t\t\t</button>\n\t\t\t\t})\n\t\t\t}\n\t\t\t</div>\n\t\t</>}\n\t</div>\n}\n\nexport default TripTimesListingV2"],"sourceRoot":""}