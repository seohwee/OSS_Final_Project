(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{105:function(e,t,n){"use strict";var r=n(7),a=n.n(r),c=n(0),i=(n(1),n(98));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var o=lodash,s=(_wp_travel.currency_symbol,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},_wp_travel.strings)),u=function(e){var t=e.groupPricings;return Object(c.createElement)("div",{className:"discount-table"},Object(c.createElement)("table",null,Object(c.createElement)("thead",{className:"discount-thead"},Object(c.createElement)("tr",null,Object(c.createElement)("th",{colSpan:"2"},wp_travel.strings.bookings.pax),Object(c.createElement)("th",{rowSpan:"2"},wp_travel.strings.bookings.price)),Object(c.createElement)("tr",null,Object(c.createElement)("th",null,wp_travel.strings.from),Object(c.createElement)("th",null,wp_travel.strings.to))),Object(c.createElement)("tbody",{className:"discount-tbody"},t.map((function(e,t){return Object(c.createElement)("tr",{key:t},Object(c.createElement)("td",null,e.min_pax),Object(c.createElement)("td",null,e.max_pax),Object(c.createElement)("td",{dangerouslySetInnerHTML:{__html:Object(i.a)(e.price)}}))})))))};t.a=function(e){var t=e.pricing,n=e.onPaxChange,r=e.counts,a=e.inventory,l=t&&t.categories||[],p=function(e,n){var a=t.categories.find((function(t){return t.id==e}));if(a){var c=r[e]||0,i=a&&a.is_sale?a.sale_price:a.regular_price;if(a.has_group_price&&a.group_prices.length>0){var l=o.orderBy(a.group_prices,(function(e){return parseInt(e.max_pax)})).find((function(e){return parseInt(e.min_pax)<=c&&parseInt(e.max_pax)>=c}));if(l&&l.price){if(n)return parseFloat(l.price);i="group"===a.price_per?c>0?parseFloat(l.price):0:parseFloat(l.price)*c}else{if(n)return parseFloat(i);i="group"===a.price_per?c>0?parseFloat(i):0:parseFloat(i)*c}}else{if(n)return parseFloat(i);i="group"===a.price_per?c>0?parseFloat(i):0:parseFloat(i)*c}return i||0}};return Object(c.createElement)("div",{className:"wp-travel-booking__pax-selector-wrapper"},Object(c.createElement)("h4",null,s.bookings.booking_tab_pax_selector),Object(c.createElement)("ul",{className:"wp-travel-booking__trip-option-list"},l.map((function(e,l){e.is_sale?e.sale_price:e.regular_price;return void 0===e.term_info?Object(c.createElement)(c.Fragment,null):Object(c.createElement)("li",{key:l},Object(c.createElement)("div",{className:"text-left"},Object(c.createElement)("strong",null,"".concat(e.term_info.title)," Â ",a&&a.length<2&&void 0!==a[0]&&a[0].booked_pax>0?Object(c.createElement)("span",{className:"wp_travel_pax_info"},"(","".concat(r[e.id]),"/","".concat(a[0].pax_available),")"):Object(c.createElement)("span",{className:"wp_travel_pax_info"},"(","".concat(r[e.id]),"/","".concat(t.max_pax),")")),e.has_group_price&&e.group_prices.length>0&&Object(c.createElement)("span",{className:"tooltip group-discount-button"},Object(c.createElement)("span",null,s.bookings.group_discount_tooltip),Object(c.createElement)("svg",{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 512.003 512.003",style:{enableBackground:"new 0 0 512.003 512.003"}},Object(c.createElement)("path",{d:"M477.958,262.633c-2.06-4.215-2.06-9.049,0-13.263l19.096-39.065c10.632-21.751,2.208-47.676-19.178-59.023l-38.41-20.38 c-4.144-2.198-6.985-6.11-7.796-10.729l-7.512-42.829c-4.183-23.846-26.241-39.87-50.208-36.479l-43.053,6.09 c-4.647,0.656-9.242-0.838-12.613-4.099l-31.251-30.232c-17.401-16.834-44.661-16.835-62.061,0L193.72,42.859 c-3.372,3.262-7.967,4.753-12.613,4.099l-43.053-6.09c-23.975-3.393-46.025,12.633-50.208,36.479l-7.512,42.827 c-0.811,4.62-3.652,8.531-7.795,10.73l-38.41,20.38c-21.386,11.346-29.81,37.273-19.178,59.024l19.095,39.064 c2.06,4.215,2.06,9.049,0,13.263l-19.096,39.064c-10.632,21.751-2.208,47.676,19.178,59.023l38.41,20.38 c4.144,2.198,6.985,6.11,7.796,10.729l7.512,42.829c3.808,21.708,22.422,36.932,43.815,36.93c2.107,0,4.245-0.148,6.394-0.452 l43.053-6.09c4.643-0.659,9.241,0.838,12.613,4.099l31.251,30.232c8.702,8.418,19.864,12.626,31.03,12.625 c11.163-0.001,22.332-4.209,31.03-12.625l31.252-30.232c3.372-3.261,7.968-4.751,12.613-4.099l43.053,6.09 c23.978,3.392,46.025-12.633,50.208-36.479l7.513-42.827c0.811-4.62,3.652-8.531,7.795-10.73l38.41-20.38 c21.386-11.346,29.81-37.273,19.178-59.024L477.958,262.633z M196.941,123.116c29.852,0,54.139,24.287,54.139,54.139 s-24.287,54.139-54.139,54.139s-54.139-24.287-54.139-54.139S167.089,123.116,196.941,123.116z M168.997,363.886 c-2.883,2.883-6.662,4.325-10.44,4.325s-7.558-1.441-10.44-4.325c-5.766-5.766-5.766-15.115,0-20.881l194.889-194.889 c5.765-5.766,15.115-5.766,20.881,0c5.766,5.766,5.766,15.115,0,20.881L168.997,363.886z M315.061,388.888 c-29.852,0-54.139-24.287-54.139-54.139s24.287-54.139,54.139-54.139c29.852,0,54.139,24.287,54.139,54.139 S344.913,388.888,315.061,388.888z"}),Object(c.createElement)("path",{d:"M315.061,310.141c-13.569,0-24.609,11.039-24.609,24.608s11.039,24.608,24.609,24.608 c13.569,0,24.608-11.039,24.608-24.608S328.63,310.141,315.061,310.141z"}),Object(c.createElement)("path",{d:"M196.941,152.646c-13.569,0-24.608,11.039-24.608,24.608c0,13.569,11.039,24.609,24.608,24.609 c13.569,0,24.609-11.039,24.609-24.609C221.549,163.686,210.51,152.646,196.941,152.646z"})),s.bookings.view_group_discount,e.has_group_price&&e.group_prices.length>0&&Object(c.createElement)(u,{groupPricings:e.group_prices}))),Object(c.createElement)("div",{className:"text-right"},Object(c.createElement)("span",{className:"item-price"},e.is_sale&&Object(c.createElement)("del",{dangerouslySetInnerHTML:{__html:Object(i.a)(e.regular_price)}})," ",Object(c.createElement)("span",{dangerouslySetInnerHTML:{__html:Object(i.a)(p(e.id,!0))}}),"/",e.price_per),Object(c.createElement)("div",{className:"pricing-area"},Object(c.createElement)("div",{className:"qty-spinner"},Object(c.createElement)("button",{onClick:n(e.id,-1)},"-"),Object(c.createElement)("span",null,void 0===r[e.id]?parseInt(e.default_pax):r[e.id]),Object(c.createElement)("button",{onClick:n(e.id,1)},"+")))))}))))}},106:function(e,t,n){"use strict";var r=n(7),a=n.n(r),c=n(0);n(1);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},_wp_travel.strings);t.a=function(e){var t=e.selected,n=e.options,r=e.onTimeSelect;return Object(c.createElement)("div",{className:"wp-travel-booking__selected-time"},n.length>0&&Object(c.createElement)(c.Fragment,null,Object(c.createElement)("h4",null,"".concat(l.bookings.available_trip_times)),n.map((function(e,n){return Object(c.createElement)("button",{key:n,disabled:e.isSame(t),onClick:r(e)},e.format("h:mm A"))}))))}},107:function(e,t,n){"use strict";var r=n(7),a=n.n(r),c=n(0),i=(n(1),n(98));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}_wp_travel.currency_symbol;var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},_wp_travel.strings);t.a=function(e){var t=e.options,n=e.onChange,r=e.counts,a=function(e,a){return function(){var c=t[e].id,i=r[c]+a<0?0:r[c]+a;t[e].is_required&&i<=0&&(i=1),n(c,i)()}};return Object(c.createElement)("div",{className:"wp-travel-booking__trip-extras-wrapper"},t.length>0&&Object(c.createElement)(c.Fragment,null,Object(c.createElement)("h4",null,o.bookings.trip_extras_list_label),Object(c.createElement)("ul",{className:"wp-travel-booking__trip-option-list"},t.map((function(e,t){if(void 0===e.tour_extras_metas)return Object(c.createElement)("li",{key:t},Object(c.createElement)("span",{className:"checkbox checked"},Object(c.createElement)("svg",{className:"tick",version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"}},Object(c.createElement)("path",{d:"M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0 c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7 C514.5,101.703,514.499,85.494,504.502,75.496z"}))),Object(c.createElement)("div",{className:"text-left"},Object(c.createElement)("strong",null,e.title),e.content&&Object(c.createElement)("div",null,Object(c.createElement)("p",{dangerouslySetInnerHTML:{__html:e.content}}))));var n=e.is_sale&&e.tour_extras_metas.extras_item_sale_price||e.tour_extras_metas.extras_item_price;n=parseFloat(n);var l=r[e.id];return Object(c.createElement)("li",{key:t,className:e.is_required?"wp-travel__required-extra":""},Object(c.createElement)("span",{className:"checkbox".concat(l>0?" checked":"")},Object(c.createElement)("svg",{className:"tick",version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"}},Object(c.createElement)("path",{d:"M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0 c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7 C514.5,101.703,514.499,85.494,504.502,75.496z"}))),Object(c.createElement)("div",{className:"text-left"},Object(c.createElement)("div",{className:"title"},Object(c.createElement)("strong",null,e.title)),Object(c.createElement)("div",{className:"info-container"},Object(c.createElement)("a",{className:"info"},e.content&&Object(c.createElement)(c.Fragment,null,Object(c.createElement)("div",{className:"info-icon"},Object(c.createElement)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",class:"svg-inline--fa fa-info-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},Object(c.createElement)("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}))),Object(c.createElement)("div",{className:"infoBox"},Object(c.createElement)("p",{className:"desc",dangerouslySetInnerHTML:{__html:"".concat(e.content).concat(e.link&&'<a target="new" href="'.concat(e.link,'">').concat(o.bookings.trip_extras_link_label,"</a>"))}})))))),Object(c.createElement)("div",{className:"text-right"},Object(c.createElement)("span",{className:"item-price"},e.is_sale&&Object(c.createElement)("del",{dangerouslySetInnerHTML:{__html:Object(i.a)(e.tour_extras_metas.extras_item_price)}})," ",Object(c.createElement)("span",{dangerouslySetInnerHTML:{__html:Object(i.a)(n)}})," /unit"),Object(c.createElement)("div",{className:"pricing-area"},Object(c.createElement)("div",{className:"qty-spinner"},Object(c.createElement)("button",{onClick:a(t,-1)},"-"),Object(c.createElement)("span",null,l),Object(c.createElement)("button",{onClick:a(t,1)},"+")))))})))))}},108:function(e,t,n){"use strict";var r=n(0);t.a=function(){return Object(r.createElement)("div",{className:"wptravel-loader"},Object(r.createElement)("div",null),Object(r.createElement)("div",null),Object(r.createElement)("div",null),Object(r.createElement)("div",null))}},204:function(e,t,n){"use strict";n.r(t);var r=n(10),a=n.n(r),c=n(7),i=n.n(c),l=n(0),o=n(9),s=n.n(o),u=n(4),p=n(5),m=(n(1),n(87)),d=n.n(m),_=n(94),f=n(45),b=n(98),v=n(127),g=n.n(v);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var j=lodash,E=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},_wp_travel.strings),y=function(e){var t=e.selected,n=e.options,r=e.onPricingSelect,a=Object(u.useSelect)((function(e){return e("WPTravelFrontend/BookingWidget").getAllStore()}),[]),c=a.tripData&&a.tripData.pricings&&j.keyBy(a.tripData.pricings,(function(e){return e.id}));return Object(l.createElement)("div",{className:"wp-travel-booking__pricing-name"},n.length>1&&Object(l.createElement)(l.Fragment,null,Object(l.createElement)("h4",null,E.bookings.pricings_list_label),n.map((function(e,n){return Object(l.createElement)("button",{key:n,disabled:t==e,className:t==e?"active":"",onClick:r(e)},c[e]&&c[e].title)}))))},w=n(105),h=n(106),D=n(107);n(108);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=Object(l.lazy)((function(){return n.e(5).then(n.bind(null,203))})),M=lodash,P=(_wp_travel.currency_symbol,function(e){var t=e.children;e.className;return Object(l.createElement)("div",{className:"wp-travel-booking__notice is-info"},Object(l.createElement)("svg",{id:"Capa_1",enableBackground:"new 0 0 524.235 524.235",height:"512",viewBox:"0 0 524.235 524.235",width:"512"},Object(l.createElement)("path",{d:"m262.118 0c-144.53 0-262.118 117.588-262.118 262.118s117.588 262.118 262.118 262.118 262.118-117.588 262.118-262.118-117.589-262.118-262.118-262.118zm17.05 417.639c-12.453 2.076-37.232 7.261-49.815 8.303-10.651.882-20.702-5.215-26.829-13.967-6.143-8.751-7.615-19.95-3.968-29.997l49.547-136.242h-51.515c-.044-28.389 21.25-49.263 48.485-57.274 12.997-3.824 37.212-9.057 49.809-8.255 7.547.48 20.702 5.215 26.829 13.967 6.143 8.751 7.615 19.95 3.968 29.997l-49.547 136.242h51.499c.01 28.356-20.49 52.564-48.463 57.226zm15.714-253.815c-18.096 0-32.765-14.671-32.765-32.765 0-18.096 14.669-32.765 32.765-32.765s32.765 14.669 32.765 32.765c0 18.095-14.668 32.765-32.765 32.765z"})),t)}),T={selectedDate:null,selectedTripDate:[],nomineePricings:[],nomineeTimes:[],selectedPricing:null,selectedDateTime:null,selectedTime:null,rruleAll:{},paxCounts:{},tripExtras:{},inventory:[],isLoading:!1,excludedDateTimes:[],pricingUnavailable:!1,tempExcludeDate:[]},N=k({},_wp_travel.strings),S=function(e){var t=e.inventory,n=(t.wp_travel_inventory_pax_limit_type,t.wp_travel_inventory_sold_out_action),r=(t.wp_travel_inventory_custom_max_pax,t.wp_travel_inventory_sold_out_message);t.wp_travel_inventory_status_message_format;return"show_sold_out_msg_only"==n?Object(l.createElement)("p",{className:"wp-travel-sold-out"},r):"allow_trip_enquiry"==n?Object(l.createElement)("p",{className:"wp-travel-sold-out"},Object(l.createElement)("a",{className:"wp-travel-send-enquiries","data-effect":"mfp-move-from-top",href:"#wp-travel-enquiries",onClick:function(){var e=document.getElementById("wp-travel-send-enquiries");e&&e.click()}},N.trip_enquiry)):Object(l.createElement)("p",null,N.bookings.pricing_not_available)};t.default=function(){var e=Object(l.useState)(T),t=a()(e,2),n=t[0],r=n.selectedDate,c=n.selectedTripDate,o=n.selectedTime,m=n.nomineePricings,v=n.nomineeTimes,O=n.selectedPricing,j=n.selectedDateTime,E=n.excludedDateTimes,x=(n.rruleAll,n.paxCounts),C=n.tripExtras,F=n.inventory,L=n.isLoading,I=n.pricingUnavailable,B=n.tempExcludeDate,H=t[1],z=function(e){H((function(t){return k(k({},t),e)}))},q=Object(u.useSelect)((function(e){return e("WPTravelFrontend/BookingWidget").getAllStore()}),[]),U=q.tripData&&q.tripData.pricings&&M.keyBy(q.tripData.pricings,(function(e){return e.id})),A=void 0!==q.tripData.dates&&q.tripData.dates.length>0?q.tripData.dates:[],R=q.tripData.is_fixed_departure||!1,W=q.tripData.inventory&&"yes"===q.tripData.inventory.enable_trip_inventory,V=M.keyBy(A,(function(e){return e.id})),J=q.tripData.trip_duration.days&&parseInt(q.tripData.trip_duration.days)||1,X=q.tripData.excluded_dates_times&&q.tripData.excluded_dates_times.length>0&&q.tripData.excluded_dates_times||[],Q=[];Object(l.useEffect)((function(){Q=(Q=X.filter((function(e){if(e.trip_time.length>0){var t=e.trip_time.split(",").map((function(t){return d()("".concat(e.start_date," ").concat(t)).toDate()}));return j&&!X.includes(d()(e.start_date).format("YYYY-MM-DD"))||E.push(t[0]),!1}return!0}))).map((function(e){return e.start_date})),z({tempExcludeDate:Q})}),[j]),Object(l.useEffect)((function(){R||(z({nomineePricings:Object.keys(U)}),L&&z({isLoading:!1}))}),[r]),Object(l.useEffect)((function(){1===m.length&&(ce(m[0])(),z({isLoading:!0}))}),[r]),Object(l.useEffect)((function(){if(O){var e={pricingUnavailable:!1},t=re(O,c);if(L)if(W&&R)ae(O,r,t);else{var n=U[O],a=n.categories,l={};a.forEach((function(e){l=k(k({},l),{},i()({},e.id,parseInt(e.default_pax)||0))}));var o=n.max_pax||999,s={};if(n.trip_extras.length>0&&n.trip_extras.forEach((function(e){s=k(k({},s),{},i()({},e.id,e.is_required?1:0))})),e=k(k({},e),{},{isLoading:!1,inventory:[{date:d()(j).format("YYYY-MM-DD[T]HH:mm"),pax_available:o,booked_pax:0,pax_limit:o}],nomineeTimes:[],tripExtras:s,paxCounts:l}),t.length>0){var u=t.map((function(e){return d()("".concat(r.toDateString()," ").concat(e))})).filter((function(e){return!E.find((function(t){return d()(t).isSame(e)}))}));e=k(k({},e),{},{selectedDateTime:u[0].toDate(),selectedTime:u[0].format("HH:mm"),nomineeTimes:u,inventory:[{date:u[0].format("YYYY-MM-DD[T]HH:mm"),pax_available:o,booked_pax:0,pax_limit:o}]})}}z(e)}}),[O,j]),Object(l.useEffect)((function(){if(!W&&O){var e=U[O].max_pax||999;z({inventory:[{date:d()(j).format("YYYY-MM-DD[T]HH:mm"),pax_available:e,booked_pax:0,pax_limit:e}]})}}),[j]);var $=function(e,t){var n={freq:_.c.DAILY,dtstart:t.toDate(),until:t.toDate()},r=e.years?e.years.split(",").filter((function(e){return"every_year"!=e})).map((function(e){return parseInt(e)})):[];if(r.length>0&&!r.includes(t.year()))return[];var a=e.months?e.months.split(",").filter((function(e){return"every_month"!=e})):[],c=e.date_days?e.date_days.split(",").filter((function(e){return"every_weekdays"!==e&&""!==e})):[],i=e.days?e.days.split(",").filter((function(e){return"every_date_days"!==e&&""!==e})):[];return a.length>0&&(n.bymonth=a.map((function(e){return parseInt(e)}))),i.length>0?n.byweekday=i.map((function(e){return _.c[e]})):c.length>0&&(n.bymonthday=c.map((function(e){return parseInt(e)}))),new _.c(n).all()},G=function(e){if(d()(e).isBefore(d()(new Date)))return!1;if(!R)return!0;var t=e.getFullYear(),n=e.getDate(),r=e.getMonth(),a=d()(new Date(Date.UTC(t,r,n,0,0,0))).utc();if(B.includes(a.format("YYYY-MM-DD")))return!1;var c=A.find((function(t){if(t.is_recurring){var n=t.years?t.years.split(",").filter((function(e){return"every_year"!=e})).map((function(e){return parseInt(e)})):[];if(t.end_date&&"invalid date"!=d()(e).toDate().toString().toLowerCase()&&d()(e).isAfter(d()(t.end_date)))return!1;if(t.start_date&&"invalid date"!=d()(e).toDate().toString().toLowerCase()&&d()(e).isBefore(d()(t.start_date)))return!1;if(n.length>0&&!n.includes(a.year()))return!1;var r=$(t,a);if(!Object(p.applyFilters)("wpTravelRecurringCutofDateFilter",!0,r,q.tripData,e,t))return;return r.find((function(t){return d()(d()(t).format("YYYY-MM-DD")).unix()===d()(d()(e).format("YYYY-MM-DD")).unix()}))instanceof Date}if(t.start_date){if(!Object(p.applyFilters)("wpTravelCutofDateFilter",!0,q.tripData,e,t))return;return d()(e).isSame(d()(t.start_date))}return!1}));return c&&void 0!==c.id},K=function(e,t,n){var r=d()(new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0))).utc(),a=A.filter((function(n){return n.is_recurring&&(void 0===t&&"dates"===fe||"calendar"===fe)?(!n.end_date||"invalid date"==d()(e).toDate().toString().toLowerCase()||!d()(e).isAfter(d()(n.end_date)))&&$(n,r).find((function(t){return d()(d()(t).format("YYYY-MM-DD")).unix()===d()(d()(e).format("YYYY-MM-DD")).unix()}))instanceof Date:n.start_date?d()(e).isSame(d()(n.start_date)):d()(n.start_date).isSame(d()(e))})).map((function(e){return e.id}));if(!n){var c=a.map((function(e){return V[e].pricing_ids.split(",").map((function(e){return e.trim()}))}));return c=M.chain(c).flatten().uniq().value().filter((function(e){return""!=e&&void 0!==U[e]}))}return a},Z=function(e){return function(){z({selectedDateTime:e.toDate(),selectedTime:e.format("HH:mm")})}},ee=function(e,t){return function(n){U[O].categories.find((function(t){return t.id===e}));var r=x[e]+t<0?0:x[e]+t,a=F.find((function(e){return e.date===d()(j).format("YYYY-MM-DD[T]HH:mm")})),c=a&&a.pax_available;if(c>=1){if((M.size(x)>0&&Object.values(x).reduce((function(e,t){return e+t}))||0)+t>parseInt(c)){if(n.target.parentElement.querySelector(".error"))return;var l=document.createElement("em");return l.classList.add("error"),l.textContent=N.bookings.max_pax_exceeded,n.target.parentElement.appendChild(l),void setTimeout((function(){l.remove()}),1e3)}n.target.parentElement.querySelector(".error")&&n.target.parentElement.querySelector(".error").remove()}z({paxCounts:k(k({},x),{},i()({},e,r))})}},te=function(e){var t,n=0;if(t=M.size(x)>0&&Object.entries(x).map((function(e){var t=a()(e,2),r=t[0],c=t[1];return n+=parseInt(c),c>0&&ne(r,c)||0})).reduce((function(e,t){return e+t}))||0,!e||n<=0)return t;var r=O&&M.keyBy(U[O].trip_extras,(function(e){return e.id}));return t+(M.size(C)>0&&Object.entries(C).map((function(e){var t=a()(e,2),n=t[0],c=t[1],i=r[n];if(!i||void 0===i.tour_extras_metas)return 0;var l=i.is_sale&&i.tour_extras_metas.extras_item_sale_price||i.tour_extras_metas.extras_item_price;return parseFloat(l)*c})).reduce((function(e,t){return e+t}))||0)},ne=function(e,t){var n=U[O].categories.find((function(t){return t.id==e}));if(n){var r=n&&n.is_sale?n.sale_price:n.regular_price;if(n.has_group_price&&n.group_prices.length>0){var a=M.orderBy(n.group_prices,(function(e){return parseInt(e.max_pax)})).find((function(e){return parseInt(e.min_pax)<=t&&parseInt(e.max_pax)>=t}));r=a&&a.price?"group"===n.price_per?t>0&&parseFloat(a.price)||0:parseFloat(a.price)*t:"group"===n.price_per?t>0&&parseFloat(r)||0:parseFloat(r)*t}else r="group"===n.price_per?t>0&&parseFloat(r)||0:parseFloat(r)*t;return r||0}},re=function(e,t){var n=t.map((function(t){var n=V[t];if(n.pricing_ids&&n.pricing_ids.split(",").includes(e)){var r=n.trip_time&&n.trip_time.split(",")||[];return r=Object(p.applyFilters)("wpTravelCutofTimeFilter",r,q.tripData,j)}return[]}));return M.chain(n).flatten().uniq().value()},ae=function(e,t,n){s()({url:"".concat(_wp_travel.ajax_url,"?action=wp_travel_get_inventory&pricing_id=").concat(e,"&trip_id=").concat(q.tripData.id,"&selected_date=").concat(d()(t).format("YYYY-MM-DD"),"&times=").concat(n.join(),"&_nonce=").concat(_wp_travel._nonce)}).then((function(t){if(t.success&&"WP_TRAVEL_INVENTORY_INFO"===t.data.code){if(t.data.inventory.length<=0)return;var r=t.data.inventory.filter((function(e){return e.pax_available>0&&!E.find((function(t){return d()(t).isSame(d()(e.date))}))})).map((function(e){return d()(e.date)})),a={isLoading:!1},c={},l=U[e];l.trip_extras.length>0&&(l.trip_extras.forEach((function(e){c=k(k({},c),{},i()({},e.id,e.is_required?1:0))})),a=k(k({},a),{},{tripExtras:c}));var o=l.categories,s={};o.forEach((function(e){s=k(k({},s),{},i()({},e.id,parseInt(e.default_pax)||0))})),a=k(k({},a),{},{paxCounts:s}),a=r.length>0&&k(k({},a),{},{selectedDateTime:r[0].toDate(),selectedTime:r[0].format("HH:mm")})||a,a=n.length>0&&k(k({},a),{},{nomineeTimes:r})||a,r.length<=0&&(a=k(k({},a),{},{pricingUnavailable:!0})),a=t.data.inventory.length>0&&k(k({},a),{},{inventory:t.data.inventory})||k(k({},a),{},{pricingUnavailable:!0}),z(a)}}))},ce=function(e){return function(){var t={isLoading:!0};t.selectedPricing=e,z(t)}};Object(l.useEffect)((function(){jQuery(".wti__selector-item.active").find(".wti__selector-content-wrapper").slideDown()}));var ie=Object(l.forwardRef)((function(e,t){e.value;var n=e.onClick;return _wp_travel.itinerary_v2?Object(l.createElement)("button",{className:"wp-travel-date-picker-btn",onClick:n},r?!R&&"".concat(d()(r).format("MMM D, YYYY")," - ").concat(d()(r).add(J-1,"days").format("MMM D, YYYY"))||d()(r).format("MMM D, YYYY"):N.bookings.date_select,Object(l.createElement)("span",null,Object(l.createElement)("i",{className:"far fa-calendar-alt"}))):Object(l.createElement)("button",{className:"wp-travel-date-picker-btn",onClick:n},r?!R&&"".concat(d()(r).format("MMM D, YYYY")," - ").concat(d()(r).add(J-1,"days").format("MMM D, YYYY"))||d()(r).format("MMM D, YYYY"):N.bookings.date_select,Object(l.createElement)("span",null,Object(l.createElement)("svg",{enableBackground:"new 0 0 512 512",height:"512",viewBox:"0 0 512 512",width:"512",xmlns:"http://www.w3.org/2000/svg"},Object(l.createElement)("g",null,Object(l.createElement)("path",{d:"m446 40h-46v-24c0-8.836-7.163-16-16-16s-16 7.164-16 16v24h-224v-24c0-8.836-7.163-16-16-16s-16 7.164-16 16v24h-46c-36.393 0-66 29.607-66 66v340c0 36.393 29.607 66 66 66h380c36.393 0 66-29.607 66-66v-340c0-36.393-29.607-66-66-66zm-380 32h46v16c0 8.836 7.163 16 16 16s16-7.164 16-16v-16h224v16c0 8.836 7.163 16 16 16s16-7.164 16-16v-16h46c18.748 0 34 15.252 34 34v38h-448v-38c0-18.748 15.252-34 34-34zm380 408h-380c-18.748 0-34-15.252-34-34v-270h448v270c0 18.748-15.252 34-34 34z"})))))})),le=M.chain(A).sortBy((function(e){return d()(e.start_date).unix()})).value()||[],oe=(le=le.find((function(e){return d()(e.start_date).isAfter(d()(new Date))||d()(e.start_date).isSame(d()(new Date))})))&&d()(le.start_date).toDate()||new Date,se=new Date((new Date).setFullYear((new Date).getFullYear()+10)),ue={showMonthDropdown:!0,customInput:Object(l.createElement)(ie,{isFixedDeparture:R,duration:J,selectedDate:r}),showYearDropdown:!0,dropdownMode:"select",minDate:oe,maxDate:se,onChange:function(e,t){if(R){z(k(k({},T),{},{excludedDateTimes:E,isLoading:!0,pricingUnavailable:!1}));var n={selectedDate:e,selectedDateTime:e},r=d()(new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0))).utc(),a=A.filter((function(n){return n.is_recurring&&(void 0===t&&"dates"===fe||"calendar"===fe)?(!n.end_date||"invalid date"==d()(e).toDate().toString().toLowerCase()||!d()(e).isAfter(d()(n.end_date)))&&$(n,r).find((function(t){return d()(d()(t).format("YYYY-MM-DD")).unix()===d()(d()(e).format("YYYY-MM-DD")).unix()}))instanceof Date:n.start_date?d()(e).isSame(d()(n.start_date)):d()(n.start_date).isSame(d()(e))})).map((function(e){return e.id})),c=a.map((function(e){return V[e].pricing_ids.split(",").map((function(e){return e.trim()}))}));n=(c=M.chain(c).flatten().uniq().value().filter((function(e){return""!=e&&void 0!==U[e]}))).length<=0?k(k({},n),{},{pricingUnavailable:!0}):k(k({},n),{},{nomineePricings:c}),n=k(k({},n),{},{selectedTripDate:a,isLoading:!1}),z(n)}else z({pricingUnavailable:!1,selectedDate:e,selectedDateTime:e,isLoading:!0})},filterDate:G};R||(delete ue.filterDate,ue.minDate=new Date,ue.startDate=r,ue.endDate=d()(r).add(J-1,"days").toDate());var pe=M.size(x)>0&&Object.values(x).reduce((function(e,t){return e+t}))||0,me=O&&U[O].min_pax&&parseInt(U[O].min_pax)||1,de=F.find((function(e){return e.date===d()(j).format("YYYY-MM-DD[T]HH:mm")})),_e=de&&parseInt(de.pax_available),fe=_wp_travel.trip_date_listing,be={pricing:U[O]||null,onPaxChange:ee,counts:x,inventory:F,selectedPricingId:O,selectedDateIds:c,selectedDateTime:j,onTimeSelect:Z,nomineeTimes:v,totalPax:pe,tripExtras:C,updateState:z,isLoading:L};return Object(l.createElement)(l.Fragment,null,Object(l.createElement)("div",{className:"wp-travel-booking__header"},Object(l.createElement)("h3",null,N.booking_tab_content_label),r&&Object(l.createElement)("button",{onClick:function(){var e=Object.assign(T);R||delete e.nomineePricings,z(e)}},Object(l.createElement)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:0,y:0,viewBox:"0 0 36.9 41.7"},Object(l.createElement)("path",{d:"M35.8,17.1l-2.8,1c0.6,1.7,0.9,3.4,0.9,5.2c0,8.5-6.9,15.4-15.4,15.4C9.9,38.7,3,31.8,3,23.3C3,14.8,9.9,7.8,18.4,7.8 c1.3,0,2.6,0.2,3.9,0.5l-2.8,3l2.2,2L25,9.9l2.3-2.4L26,4.4L24.2,0l-2.8,1.1l1.8,4.3c-1.5-0.4-3.1-0.6-4.7-0.6 C8.3,4.8,0,13.1,0,23.3c0,10.2,8.3,18.4,18.4,18.4c10.2,0,18.4-8.3,18.4-18.4C36.9,21.2,36.5,19.1,35.8,17.1z"})),N.bookings.booking_tab_clear_all)),R&&"dates"===fe&&Object(l.createElement)("div",{className:"wp-travel-booking__content-wrapper"},Object(l.createElement)(Y,{dates:V,isTourDate:G,getPricingsByDate:K,allData:q,onFixedDeparturePricingSelect:function(e,t,n){if(R){z(k(k({},T),{},{excludedDateTimes:E,isLoading:!0,pricingUnavailable:!1}));var r={selectedDate:e,selectedDateTime:e},a=K(e,t,!0),c=a.map((function(e){return V[e].pricing_ids.split(",").map((function(e){return e.trim()}))}));r=(c=M.chain(c).flatten().uniq().value().filter((function(e){return""!=e&&void 0!==U[e]}))).length<=0?k(k({},r),{},{pricingUnavailable:!0}):k(k({},r),{},{nomineePricings:c}),r=k(k({},r),{},{selectedTripDate:a,isLoading:!0,selectedPricing:n}),z(r)}else z({pricingUnavailable:!1,selectedDate:e,selectedDateTime:e,isLoading:!0})},componentData:be,getPricingTripTimes:re}))||Object(l.createElement)("div",{className:"wp-travel-booking__datepicker-wrapper"},Object(l.createElement)(g.a,ue),!j&&Object(l.createElement)("p",null,N.bookings.date_select_to_view_options)||null),j&&Object(l.createElement)(l.Fragment,null,Object(l.createElement)("div",{className:L?"wp-travel-booking__pricing-wrapper wptravel-loading":"wp-travel-booking__pricing-wrapper"},m.length>1&&Object(l.createElement)(f.a,null,Object(l.createElement)(y,{selected:O,options:m,onPricingSelect:ce})),!I&&v.length>0&&Object(l.createElement)(f.a,null,Object(l.createElement)(h.a,{selected:j,onTimeSelect:Z,options:v}))),Object(l.createElement)("div",{className:"wp-travel-booking__pricing-wrapper wptravel-pax-selector"},!I&&O&&F.find((function(e){return e.pax_available>0}))&&Object(l.createElement)(f.a,null,Object(l.createElement)(w.a,{pricing:U[O]||null,onPaxChange:ee,counts:x,inventory:F})),!I&&pe>0&&M.size(U[O].trip_extras)>0&&Object(l.createElement)(f.a,null,Object(l.createElement)(D.a,{options:U[O].trip_extras,onChange:function(e,t){return function(){return z({tripExtras:k(k({},C),{},i()({},e,parseInt(t)))})}},counts:C})),I&&Object(l.createElement)(l.Fragment,null,Object(l.createElement)(P,null,q&&q.tripData.inventory&&"yes"==q.tripData.inventory.enable_trip_inventory&&Object(l.createElement)(S,{inventory:q.tripData.inventory})))),O&&Object(l.createElement)(l.Fragment,null,Object(l.createElement)("div",{className:"wp-travel-booking__panel-bottom"},Object(l.createElement)("div",{className:"left-info"},O&&Object(l.createElement)("p",null,Object(l.createElement)("strong",null,"Pricing"),": ",U[O].title),j&&Object(l.createElement)("p",null,Object(l.createElement)("strong",null,"Trip Date"),": ",Object(l.createElement)("span",null,d()(j).format(_wp_travel.date_format_moment)))),Object(l.createElement)("div",{className:"right-info"},Object(l.createElement)("p",null,N.bookings.booking_tab_cart_total,Object(l.createElement)("strong",{dangerouslySetInnerHTML:{__html:Object(b.a)(te(!0))}})),Object(l.createElement)("button",{disabled:pe<me||pe>_e,onClick:function(){var e={trip_id:q.tripData.id,arrival_date:d()(j).format("YYYY-MM-DD"),pricing_id:O,pax:x,category_pax:x,trip_price:te()};o&&(e.trip_time=d()(j).format("HH:mm"));var t={};Object.entries(C).forEach((function(e){var n=a()(e,2),r=n[0],c=n[1];c>0&&(t=k(k({},t),{},i()({},r,c)))})),M.size(t)>0&&(e.wp_travel_trip_extras={id:Object.keys(t),qty:Object.values(t)}),Object(b.b)(s()({url:"".concat(wp_travel.ajaxUrl,"?action=wp_travel_add_to_cart&_nonce=").concat(_wp_travel._nonce),method:"POST",data:e}).then((function(e){!0===e.success&&"WP_TRAVEL_ADDED_TO_CART"===e.data.code&&(wp_travel.isEnabledCartPage?location.href=wp_travel.cartUrl:location.href=wp_travel.checkoutUrl)})),1e3).catch((function(e){alert("[X] Request Timeout!")}))},className:"wp-travel-book"},N.bookings.booking_tab_booking_btn_label))))))}},98:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=_wp_travel,a=(r.currency,r.currency_symbol),c=r.currency_position,i=r.decimal_separator,l=r.number_of_decimals,o=r.thousand_separator,s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currency",n=new RegExp("\\d(?=(\\d{3})+\\".concat(i,")"),"gi"),r="$&".concat(o),s=parseFloat(e).toFixed(l).replace(/\./,i).replace(n,r);if("decimal"==t)return s;var u={left:"".concat(a,"<span>").concat(s,"</span>"),left_with_space:"".concat(a," <span>").concat(s,"</span>"),right:"<span>".concat(s,"</span>").concat(a),right_with_space:"<span>".concat(s,"</span> ").concat(a)};return u[c]},u=function(e){return new Promise((function(t,n){setTimeout((function(){n(new Error("[X] Timeout!"))}),1e3),t(e.then())}))}}}]);